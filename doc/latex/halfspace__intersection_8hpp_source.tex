\doxysection{halfspace\+\_\+intersection.\+hpp}
\hypertarget{halfspace__intersection_8hpp_source}{}\label{halfspace__intersection_8hpp_source}\index{src/halfspace\_intersection.hpp@{src/halfspace\_intersection.hpp}}
\mbox{\hyperlink{halfspace__intersection_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ HALFSPACE\_INTERSECTION\_HPP}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ HALFSPACE\_INTERSECTION\_HPP}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{common_8hpp}{common.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dvector_8hpp}{dvector.hpp}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{reusable__used__array_8hpp}{reusable\_used\_array.hpp}}"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{timer_8hpp}{timer.hpp}}"{}}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{comment}{//\ an\ (oriented)\ primal-\/dual\ edge\ represented\ by\ primal\ and\ dual\ indices}}
\DoxyCodeLine{00010\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpdedge}{pdedge}}\ \{}
\DoxyCodeLine{00011\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}},\ \mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}};\ \textcolor{comment}{//\ primal\ indices\ neighboring}}
\DoxyCodeLine{00012\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}},\ \mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}};\ \textcolor{comment}{//\ corresponding\ dual\ indices\ neighboring}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \ \ \textcolor{comment}{//\ pdedge(const\ pdedge\&)\ =\ default;}}
\DoxyCodeLine{00015\ \ \ \textcolor{comment}{//\ pdedge(pdedge\&\&)\ =\ default;}}
\DoxyCodeLine{00016\ \ \ \textcolor{comment}{//\ pdedge\&\ operator=(const\ pdedge\&)\ =\ default;}}
\DoxyCodeLine{00017\ \ \ \textcolor{comment}{//\ pdedge\&\ operator=(pdedge\&\&)\ =\ default;}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \ \ \textcolor{comment}{//\ get\ start\ of\ dual\ edge\ relative\ to\ primal\ index\ p\ in\ [pi,\ pj]}}
\DoxyCodeLine{00020\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&\mbox{\hyperlink{structpdedge_ad86f08eac97ea1507613fc88e0e03353}{dstart}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&p)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keywordflow}{if}\ (p\ !=\ \mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}}\ \&\&\ p\ !=\ \mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}})}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}dstart\ called\ with\ primal\ index\ that\ is\ not\ part\ of\ edge"{}});}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordflow}{return}\ (p\ ==\ \mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}})\ ?\ \mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}}\ :\ \mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}};}
\DoxyCodeLine{00026\ \ \ \}}
\DoxyCodeLine{00027\ \ \ \textcolor{comment}{//\ get\ end\ of\ dual\ edge\ relative\ to\ primal\ index\ p\ in\ [pi,\ pj]}}
\DoxyCodeLine{00028\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&\mbox{\hyperlink{structpdedge_a0f63e8859be7e43c3bfcbd79faaf9295}{dend}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&p)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordflow}{if}\ (p\ !=\ \mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}}\ \&\&\ p\ !=\ \mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}})}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}dend\ called\ with\ primal\ index\ that\ is\ not\ part\ of\ edge"{}});}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordflow}{return}\ (p\ ==\ \mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}})\ ?\ \mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}}\ :\ \mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}};}
\DoxyCodeLine{00034\ \ \ \}}
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ get\ start\ of\ primal\ edge\ relative\ to\ dual\ index\ d\ in\ [di,\ dj]}}
\DoxyCodeLine{00036\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&\mbox{\hyperlink{structpdedge_ad900081a76a1a19e258ee17f41d1b101}{pstart}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&d)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordflow}{if}\ (d\ !=\ \mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}}\ \&\&\ d\ !=\ \mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}})}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}pstart\ called\ with\ dual\ index\ that\ is\ not\ part\ of\ edge"{}});}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordflow}{return}\ (d\ ==\ \mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}})\ ?\ \mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}}\ :\ \mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}};}
\DoxyCodeLine{00042\ \ \ \}}
\DoxyCodeLine{00043\ \ \ \textcolor{comment}{//\ get\ end\ of\ primal\ edge\ relative\ to\ dual\ index\ d\ in\ [di,\ dj]}}
\DoxyCodeLine{00044\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&\mbox{\hyperlink{structpdedge_a8013d76f05594ff8fdad27fc75cd590b}{pend}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&d)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{if}\ (d\ !=\ \mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}}\ \&\&\ d\ !=\ \mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}})}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}pend\ called\ with\ dual\ index\ that\ is\ not\ part\ of\ edge"{}});}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordflow}{return}\ (d\ ==\ \mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}})\ ?\ \mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}}\ :\ \mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}};}
\DoxyCodeLine{00050\ \ \ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ std::string\ \mbox{\hyperlink{structpdedge_ad42940686343e06476e0964c91529e3b}{repr}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00053\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{00054\ \ \ \ \ ss\ <<\ \textcolor{stringliteral}{"{}PDEdge("{}}\ <<\ \mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}}\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ \mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}}\ <<\ \textcolor{stringliteral}{"{};\ "{}}\ <<\ \mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}}\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ \mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}}\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{00056\ \ \ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \mbox{\hyperlink{structpdedge}{pdedge}}\ \mbox{\hyperlink{structpdedge_a5ded78a869d97ebf4eb7a0d5ab0e5d78}{mirrored}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}},\ \mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}},\ \mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}},\ \mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}}\};}
\DoxyCodeLine{00060\ \ \ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpdedge_1_1cmp__pj}{cmp\_pj}}\ \{\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structpdedge_1_1cmp__pj_a6448ed97b35fa394b9ee24e08b0212f4}{operator()}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&e,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&f)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ e.\mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}}\ <\ f.\mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}};\ \}\ \};}
\DoxyCodeLine{00063\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpdedge_1_1cmp__dj}{cmp\_dj}}\ \{\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structpdedge_1_1cmp__dj_a5278116b73bded00ca9d039d204647f2}{operator()}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&e,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&f)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ e.\mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}}\ <\ f.\mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}};\ \}\ \};}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//\ order\ the\ given\ edges\ to\ make\ up\ a\ cycle\ on\ primal\ side\ (if\ primal\ ==\ true)\ or\ dual\ side\ (if\ primal\ ==\ false)}}
\DoxyCodeLine{00067\ \ \ \textcolor{comment}{//\ if\ the\ edges\ do\ not\ make\ up\ a\ cycle,\ a\ runtime\_error\ will\ the\ thrown}}
\DoxyCodeLine{00068\ \ \ \textcolor{comment}{//\ assumes\ edges\ are\ already\ oriented\ the\ same\ way\ and\ a\ cycle\ is\ possible}}
\DoxyCodeLine{00069\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ primal\ =\ true>}
\DoxyCodeLine{00070\ \ \ \textcolor{keyword}{static}\ std::vector<pdedge>\ \mbox{\hyperlink{structpdedge_acd41f3afab4bfdbdf041ac363fa21860}{order\_cycle}}(\textcolor{keyword}{const}\ std::vector<pdedge>\ \&edg)\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordflow}{if}\ (edg.size()\ <=\ 2)}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ edg;}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ std::map<int,\ std::vector<int>>\ adj;}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ (int)edg.size();\ ++i)\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ adj[primal\ ?\ edg[i].pi\ :\ edg[i].di].push\_back(i);}
\DoxyCodeLine{00077\ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ std::vector<bool>\ used(edg.size(),\ 0);}
\DoxyCodeLine{00079\ \ \ \ \ std::vector<pdedge>\ path;}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ std::function<void(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\&)>\ dfs\ =\ [\&](\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&ev)\{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ v\ =\ (primal\ ?\ edg[ev].pj\ :\ edg[ev].dj);}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&ew\ :\ adj[v])\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!used[ew])\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ int\ w\ =\ (primal\ ?\ edg[ew].pj\ :\ edg[ew].dj);}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ used[ew]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ dfs(ew);}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00093\ \ \ \ \ \ \ path.push\_back(edg[ev]);}
\DoxyCodeLine{00094\ \ \ \ \ \};}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ used[0]\ =\ 1;}
\DoxyCodeLine{00097\ \ \ \ \ dfs(0);}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ std::reverse(path.begin(),\ path.end());}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{if}\ (path.size()\ !=\ edg.size())}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}resulting\ path\ length\ in\ order\_cycle\ is\ too\ short"{}});}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordflow}{if}\ (primal\ ?\ (path.back().pj\ !=\ path.front().pi)\ :\ (path.back().dj\ !=\ path.front().di))}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}path\ in\ order\_cycle\ does\ not\ close"{}});}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{return}\ path;}
\DoxyCodeLine{00110\ \ \ \}}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \textcolor{comment}{//\ like\ order\_cycle\ but\ allow\ multiple\ cycles}}
\DoxyCodeLine{00113\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ primal\ =\ true>}
\DoxyCodeLine{00114\ \ \ \textcolor{keyword}{static}\ std::vector<std::vector<pdedge>>\ \mbox{\hyperlink{structpdedge_a9002d65afab23cff6089ac414470f29a}{cycle\_decomposition}}(\textcolor{keyword}{const}\ std::vector<pdedge>\ \&edg)\ \{}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{if}\ (edg.size()\ <=\ 2)}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{edg\};}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ std::unordered\_map<int,\ std::vector<int>>\ adj;}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ (int)edg.size();\ ++i)\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ adj[primal\ ?\ edg[i].pi\ :\ edg[i].di].push\_back(i);}
\DoxyCodeLine{00121\ \ \ \ \ \}}
\DoxyCodeLine{00122\ \ \ \ \ std::vector<bool>\ used(edg.size(),\ 0);}
\DoxyCodeLine{00123\ \ \ \ \ std::vector<pdedge>\ path;}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ std::function<void(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\&)>\ dfs\ =\ [\&](\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&ev)\{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ v\ =\ (primal\ ?\ edg[ev].pj\ :\ edg[ev].dj);}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&ew\ :\ adj[v])\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!used[ew])\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ int\ w\ =\ (primal\ ?\ edg[ew].pj\ :\ edg[ew].dj);}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ used[ew]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ dfs(ew);}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ path.push\_back(edg[ev]);}
\DoxyCodeLine{00138\ \ \ \ \ \};}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ std::vector<std::vector<pdedge>>\ res;}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ vs\ =\ 0;\ vs\ <\ (int)used.size();\ vs++)\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!used[vs])\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ used[vs]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ path.clear();}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ dfs(vs);}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ std::reverse(path.begin(),\ path.end());}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ res.push\_back(path);}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (primal\ ?\ (path.back().pj\ !=\ path.front().pi)\ :\ (path.back().dj\ !=\ path.front().di))}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}path\ in\ cycle\_decomposition\ does\ not\ close"{}});}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \ \ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00157\ \ \ \}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structpdedge_a4a0e60d5b30737a64504e647e8a7a925}{bind}}(py::module\_\ \&m)\ \{}
\DoxyCodeLine{00160\ \ \ \ \ py::class\_<pdedge>(m,\ \textcolor{stringliteral}{"{}PDEdge"{}})}
\DoxyCodeLine{00161\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}\_\_repr\_\_"{}},\ \&\mbox{\hyperlink{structpdedge_ad42940686343e06476e0964c91529e3b}{pdedge::repr}})}
\DoxyCodeLine{00162\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}pstart"{}},\ \&\mbox{\hyperlink{structpdedge_ad900081a76a1a19e258ee17f41d1b101}{pdedge::pstart}})}
\DoxyCodeLine{00163\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}pend"{}},\ \&\mbox{\hyperlink{structpdedge_a8013d76f05594ff8fdad27fc75cd590b}{pdedge::pend}})}
\DoxyCodeLine{00164\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}dstart"{}},\ \&\mbox{\hyperlink{structpdedge_ad86f08eac97ea1507613fc88e0e03353}{pdedge::dstart}})}
\DoxyCodeLine{00165\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}dend"{}},\ \&\mbox{\hyperlink{structpdedge_a0f63e8859be7e43c3bfcbd79faaf9295}{pdedge::dend}})}
\DoxyCodeLine{00166\ \ \ \ \ \ \ .def\_readonly(\textcolor{stringliteral}{"{}pi"{}},\ \&\mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pdedge::pi}})}
\DoxyCodeLine{00167\ \ \ \ \ \ \ .def\_readonly(\textcolor{stringliteral}{"{}pj"{}},\ \&\mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pdedge::pj}})}
\DoxyCodeLine{00168\ \ \ \ \ \ \ .def\_readonly(\textcolor{stringliteral}{"{}di"{}},\ \&\mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{pdedge::di}})}
\DoxyCodeLine{00169\ \ \ \ \ \ \ .def\_readonly(\textcolor{stringliteral}{"{}dj"{}},\ \&\mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{pdedge::dj}});}
\DoxyCodeLine{00170\ \ \ \}}
\DoxyCodeLine{00171\ \};}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T\ =\ \textcolor{keywordtype}{double}>}
\DoxyCodeLine{00174\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpdmesh}{pdmesh}}\ \{}
\DoxyCodeLine{00175\ \ \ \textcolor{keyword}{typedef}\ Eigen::Vector3<T>\ \mbox{\hyperlink{structpdmesh_ad234b7b199d38b638199ff4806f4db74}{Vec3}};}
\DoxyCodeLine{00176\ \ \ \textcolor{keyword}{typedef}\ Eigen::Vector4<T>\ \mbox{\hyperlink{structpdmesh_a35e5d2912910edc2dde6058c04c7947c}{Vec4}};}
\DoxyCodeLine{00177\ \ \ }
\DoxyCodeLine{00178\ \ \ \textcolor{comment}{//\ primal\ adjacency\ list\ -\/\ for\ each\ primal\ index:\ list\ of\ incident\ edges}}
\DoxyCodeLine{00179\ \ \ std::vector<std::vector<pdedge>>\ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}};}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \textcolor{comment}{//\ dual\ adjacency\ list\ -\/\ for\ each\ dual\ index:\ list\ of\ incident\ edges\ (3\ for\ a\ dual-\/triangle-\/mesh)}}
\DoxyCodeLine{00182\ \ \ \mbox{\hyperlink{classdvector}{dvector<std::vector<pdedge>}}>\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}};}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \textcolor{comment}{//\ primal\ vertices}}
\DoxyCodeLine{00185\ \ \ std::vector<Vec4>\ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}};}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \textcolor{comment}{//\ dual\ vertices}}
\DoxyCodeLine{00188\ \ \ \mbox{\hyperlink{classdvector}{dvector<Vec4>}}\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}};}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{classreusable__used__array}{reusable\_used\_array<>}}\ \mbox{\hyperlink{structpdmesh_a90490d62b74b97a4d91a3cfb7e8fa4e1}{used}};}
\DoxyCodeLine{00191\ \ \ }
\DoxyCodeLine{00192\ \ \ \mbox{\hyperlink{structpdmesh_a3804e631e6d2b556db8452f6a3db98b5}{pdmesh}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&\mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}\ =\ 0,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&\mbox{\hyperlink{structpdmesh_a6cbf65bd6c1df0ba4c20af5411d8f0f3}{dcnt}}\ =\ 0)\ :}
\DoxyCodeLine{00193\ \ \ \ \ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}(\mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}),\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}(\mbox{\hyperlink{structpdmesh_a6cbf65bd6c1df0ba4c20af5411d8f0f3}{dcnt}}),}
\DoxyCodeLine{00194\ \ \ \ \ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}(\mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}),\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}(\mbox{\hyperlink{structpdmesh_a6cbf65bd6c1df0ba4c20af5411d8f0f3}{dcnt}})\ \{\}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structpdmesh}{pdmesh}}\ \mbox{\hyperlink{structpdmesh_a61daed1073c764ec3b56f0c65199b4d3}{cube}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Vec3>\ \&lb,}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<const\ Vec3>\ \&ub)\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \mbox{\hyperlink{structpdmesh}{pdmesh}}\ res(6,\ 8);}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{comment}{//\ a\ cuboid\ mesh\ has\ 6\ primal\ vertices,\ 8\ dual\ vertices,\ 12\ edges}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{comment}{/*\ enumeration\ of\ primal\ and\ dual\ vertices\ is\ as\ follows:}}
\DoxyCodeLine{00203\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00204\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ \ 4-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/5}}
\DoxyCodeLine{00205\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ /|\ \ \ \ \ \ \ \ \ \ /|}}
\DoxyCodeLine{00206\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ /\ |\ \ \ 5\ \ \ \ \ /\ |\ \ \ \ \ \ \ x2}}
\DoxyCodeLine{00207\ \textcolor{comment}{\ \ \ \ \ *\ \ \ /\ \ |\ \ \ \ \ 1\ \ /\ \ |\ \ \ \ \ \ \ |}}
\DoxyCodeLine{00208\ \textcolor{comment}{\ \ \ \ \ *\ \ 6-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/7\ \ \ |\ \ \ \ \ \ \ |}}
\DoxyCodeLine{00209\ \textcolor{comment}{\ \ \ \ \ *\ \ |\ 2\ |\ \ \ \ \ \ \ |\ 3\ |\ \ \ \ \ \ \ |}}
\DoxyCodeLine{00210\ \textcolor{comment}{\ \ \ \ \ *\ \ |\ \ \ 0-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/1\ \ \ \ \ \ \ o\ -\/-\/-\/-\/-\/\ x0}}
\DoxyCodeLine{00211\ \textcolor{comment}{\ \ \ \ \ *\ \ |\ \ /\ \ 4\ \ \ \ \ |\ \ /\ \ \ \ \ \ \ /}}
\DoxyCodeLine{00212\ \textcolor{comment}{\ \ \ \ \ *\ \ |\ /\ \ \ \ \ 0\ \ \ |\ /\ \ \ \ \ \ \ /}}
\DoxyCodeLine{00213\ \textcolor{comment}{\ \ \ \ \ *\ \ |/\ \ \ \ \ \ \ \ \ \ |/\ \ \ \ \ \ \ x1}}
\DoxyCodeLine{00214\ \textcolor{comment}{\ \ \ \ \ *\ \ 2-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/3}}
\DoxyCodeLine{00215\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{comment}{//\ define\ primal\ vertex\ (i.e.\ halfspace)\ coordinates}}
\DoxyCodeLine{00218\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[0]\ =\ \{\ 0,\ \ 0,\ -\/1,\ \ lb(2)\};}
\DoxyCodeLine{00219\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[5]\ =\ \{\ 0,\ \ 0,\ \ 1,\ -\/ub(2)\};}
\DoxyCodeLine{00220\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[1]\ =\ \{\ 0,\ -\/1,\ \ 0,\ \ lb(1)\};}
\DoxyCodeLine{00221\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[4]\ =\ \{\ 0,\ \ 1,\ \ 0,\ -\/ub(1)\};}
\DoxyCodeLine{00222\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[2]\ =\ \{-\/1,\ \ 0,\ \ 0,\ \ lb(0)\};}
\DoxyCodeLine{00223\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[3]\ =\ \{\ 1,\ \ 0,\ \ 0,\ -\/ub(0)\};}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[0]\ =\ \{lb[0],\ lb[1],\ lb[2],\ 1.0\};}
\DoxyCodeLine{00226\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[1]\ =\ \{ub[0],\ lb[1],\ lb[2],\ 1.0\};}
\DoxyCodeLine{00227\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[2]\ =\ \{lb[0],\ ub[1],\ lb[2],\ 1.0\};}
\DoxyCodeLine{00228\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[3]\ =\ \{ub[0],\ ub[1],\ lb[2],\ 1.0\};}
\DoxyCodeLine{00229\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[4]\ =\ \{lb[0],\ lb[1],\ ub[2],\ 1.0\};}
\DoxyCodeLine{00230\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[5]\ =\ \{ub[0],\ lb[1],\ ub[2],\ 1.0\};}
\DoxyCodeLine{00231\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[6]\ =\ \{lb[0],\ ub[1],\ ub[2],\ 1.0\};}
\DoxyCodeLine{00232\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[7]\ =\ \{ub[0],\ ub[1],\ ub[2],\ 1.0\};}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{comment}{//\ sign\ convention:}}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{comment}{//\ when\ standing\ on\ the\ inside\ of\ the\ domain,\ looking\ from\ pi\ over\ the\ dual\ edge\ to\ pj}}
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{comment}{//\ then\ di\ is\ on\ the\ left\ and\ dj\ is\ on\ the\ right.}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{comment}{//\ when\ following\ an\ the\ edges\ starting\ at\ a\ dual\ vertex,\ e.g.\ for\ di\ =\ 0}}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{comment}{//\ \{0,\ 1,\ \_0\_,\ 1\},\ \{1,\ 2,\ \_0\_,\ 4\},\ \{2,\ 0,\ \_0\_,\ 2\}}}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{comment}{//\ looking\ from\ the\ inside,\ they\ go\ around\ counter-\/clockwise}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{comment}{//\ bottom\ edges}}
\DoxyCodeLine{00243\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{0,\ 1,\ 0,\ 1\});}
\DoxyCodeLine{00244\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{0,\ 2,\ 2,\ 0\});}
\DoxyCodeLine{00245\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{0,\ 3,\ 1,\ 3\});}
\DoxyCodeLine{00246\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{0,\ 4,\ 3,\ 2\});}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{comment}{//\ side\ edges}}
\DoxyCodeLine{00249\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{2,\ 1,\ 4,\ 0\});}
\DoxyCodeLine{00250\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{1,\ 3,\ 5,\ 1\});}
\DoxyCodeLine{00251\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{3,\ 4,\ 7,\ 3\});}
\DoxyCodeLine{00252\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{4,\ 2,\ 6,\ 2\});}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{comment}{//\ top\ edges}}
\DoxyCodeLine{00255\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{5,\ 2,\ 4,\ 6\});}
\DoxyCodeLine{00256\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{5,\ 4,\ 6,\ 7\});}
\DoxyCodeLine{00257\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{5,\ 3,\ 7,\ 5\});}
\DoxyCodeLine{00258\ \ \ \ \ res.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{5,\ 1,\ 5,\ 4\});}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00261\ \ \ \ \ \textcolor{keywordflow}{if}\ (!res.\mbox{\hyperlink{structpdmesh_abb3e165068d82f1d4ef970099c95da87}{check\_integrity}}())}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}generated\ cube\ has\ wrong\ integrity"{}});}
\DoxyCodeLine{00263\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00266\ \ \ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00269\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}.size()\ !=\ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}.size())}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}padj\ and\ pvert\ do\ not\ have\ the\ same\ size"{}});}
\DoxyCodeLine{00272\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}.size();}
\DoxyCodeLine{00274\ \ \ \}}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structpdmesh_a6cbf65bd6c1df0ba4c20af5411d8f0f3}{dcnt}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00277\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_ac98dd66e2059aed3405ff7aaeeb5949b}{size}}()\ !=\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}.\mbox{\hyperlink{classdvector_ac98dd66e2059aed3405ff7aaeeb5949b}{size}}())}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}dadj\ and\ dvert\ do\ not\ have\ the\ same\ size"{}});}
\DoxyCodeLine{00280\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_ac98dd66e2059aed3405ff7aaeeb5949b}{size}}();}
\DoxyCodeLine{00282\ \ \ \}}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \textcolor{comment}{//\ add\ primal-\/dual\ edge\ to\ mesh}}
\DoxyCodeLine{00285\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&e)\ \{}
\DoxyCodeLine{00286\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{keywordflow}{if}\ (e.\mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}}\ <\ 0\ ||\ e.\mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}}\ <\ 0\ ||\ e.\mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}}\ >=\ \mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}()\ ||\ e.\mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}}\ >=\ \mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}()\ ||}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ !\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_a4d6e03343bec9e78936aade4743eebeb}{contains\_idx}}(e.\mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}})\ ||\ !\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_a4d6e03343bec9e78936aade4743eebeb}{contains\_idx}}(e.\mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}}))}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}tried\ to\ add\ edge\ containing\ invalid\ points\ "{}}\ +\ e.\mbox{\hyperlink{structpdedge_ad42940686343e06476e0964c91529e3b}{repr}}());}
\DoxyCodeLine{00290\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[e.\mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}}].push\_back(e);}
\DoxyCodeLine{00293\ \ \ \ \ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[e.\mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}}].push\_back(e.\mbox{\hyperlink{structpdedge_a5ded78a869d97ebf4eb7a0d5ab0e5d78}{mirrored}}());}
\DoxyCodeLine{00294\ \ \ \ \ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[e.\mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}}].push\_back(e);}
\DoxyCodeLine{00295\ \ \ \ \ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[e.\mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}}].push\_back(e.\mbox{\hyperlink{structpdedge_a5ded78a869d97ebf4eb7a0d5ab0e5d78}{mirrored}}());}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \ \ \mbox{\hyperlink{structpdmesh_a1ac5b61ecff9135bf9797637259804d7}{fix\_order}}(e.\mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}});}
\DoxyCodeLine{00298\ \ \ \ \ \mbox{\hyperlink{structpdmesh_a1ac5b61ecff9135bf9797637259804d7}{fix\_order}}(e.\mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}});}
\DoxyCodeLine{00299\ \ \ \}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \textcolor{comment}{//\ remove\ primal-\/dual\ edge\ from\ mesh}}
\DoxyCodeLine{00302\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structpdmesh_a7ded63e50b60925b7050cf2e1d6f5aef}{remove\_edge}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&e)\ \{}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{comment}{//\ TODO:\ efficiency\ (using\ vectors\ may\ actually\ be\ best\ when\ number\ of\ elements\ is\ very\ small\ -\/>\ benchmark)}}
\DoxyCodeLine{00304\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keywordtype}{int}\ i0\ =}
\DoxyCodeLine{00306\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00307\ \ \ \ \ \ \ std::erase\_if(\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[e.\mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}}],\ [\&e](\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&f)\{\ return\ f.pj\ ==\ e.pj\ \&\&\ f.di\ ==\ e.di\ \&\&\ f.dj\ ==\ e.dj;\ \});}
\DoxyCodeLine{00308\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keywordtype}{int}\ i1\ =}
\DoxyCodeLine{00310\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00311\ \ \ \ \ \ \ std::erase\_if(\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[e.\mbox{\hyperlink{structpdedge_a6b68f249d42781148be9e3aa9802ae6f}{pj}}],\ [\&e](\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&f)\{\ return\ f.pj\ ==\ e.pi\ \&\&\ f.di\ ==\ e.dj\ \&\&\ f.dj\ ==\ e.di;\ \});}
\DoxyCodeLine{00312\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keywordtype}{int}\ i2\ =}
\DoxyCodeLine{00314\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ std::erase\_if(\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[e.\mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}}],\ [\&e](\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&f)\{\ return\ f.dj\ ==\ e.dj\ \&\&\ f.pi\ ==\ e.pi\ \&\&\ f.pj\ ==\ e.pj;\ \});}
\DoxyCodeLine{00316\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordtype}{int}\ i3\ =}
\DoxyCodeLine{00318\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00319\ \ \ \ \ \ \ std::erase\_if(\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[e.\mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}}],\ [\&e](\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdedge}{pdedge}}\ \&f)\{\ return\ f.dj\ ==\ e.di\ \&\&\ f.pi\ ==\ e.pj\ \&\&\ f.pj\ ==\ e.pi;\ \});}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keywordflow}{if}\ (i0\ <\ 1\ ||\ i1\ <\ 1\ ||\ i2\ <\ 1\ ||\ i3\ <\ 1)}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}tried\ to\ erase\ edge\ that\ does\ not\ exist"{}});}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keywordflow}{if}\ (i0\ >\ 1\ ||\ i1\ >\ 1\ ||\ i2\ >\ 1\ ||\ i3\ >\ 1)}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}erase\ removed\ multiple\ edges"{}});}
\DoxyCodeLine{00326\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \mbox{\hyperlink{structpdmesh_a1ac5b61ecff9135bf9797637259804d7}{fix\_order}}(e.\mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}});}
\DoxyCodeLine{00329\ \ \ \ \ \mbox{\hyperlink{structpdmesh_a1ac5b61ecff9135bf9797637259804d7}{fix\_order}}(e.\mbox{\hyperlink{structpdedge_afd69df264d6e16b0f201995423738b6d}{dj}});}
\DoxyCodeLine{00330\ \ \ \}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \textcolor{comment}{//\ remove\ dual\ vertex\ at\ index\ with\ all\ corresponding\ edges}}
\DoxyCodeLine{00333\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structpdmesh_a710421718ab1e0d8edf3b3968d1e02a1}{remove\_dual}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&di)\ \{}
\DoxyCodeLine{00334\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_a4d6e03343bec9e78936aade4743eebeb}{contains\_idx}}(di))}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}tried\ to\ erase\ dual\ that\ does\ not\ exist"{}});}
\DoxyCodeLine{00337\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di].size())\ \{}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \mbox{\hyperlink{structpdmesh_a7ded63e50b60925b7050cf2e1d6f5aef}{remove\_edge}}(\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di].back());}
\DoxyCodeLine{00341\ \ \ \ \ \}}
\DoxyCodeLine{00342\ \ \ \ \ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_ada3713327365fe661ea391d3fec32fda}{remove}}(di);}
\DoxyCodeLine{00343\ \ \ \ \ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}.\mbox{\hyperlink{classdvector_ada3713327365fe661ea391d3fec32fda}{remove}}(di);}
\DoxyCodeLine{00344\ \ \ \}}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \ \ \textcolor{comment}{//\ add\ a\ new\ dual,\ return\ the\ index}}
\DoxyCodeLine{00347\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structpdmesh_ae87ebcc57e4633f622dfd43a52a1637a}{add\_dual}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Vec4>\ \&p)\ \{}
\DoxyCodeLine{00348\ \ \ \ \ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}.\mbox{\hyperlink{classdvector_a909c289cdb91164dbfd026da52b2c85c}{add}}(p);}
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{keywordtype}{int}\ di\ =\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_a909c289cdb91164dbfd026da52b2c85c}{add}}(std::vector<pdedge>());}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{comment}{//\ py::print(FORMAT("{}add\ dual\ \{\}:\ (\{\},\ \{\},\ \{\},\ \{\})"{},}}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ di,\ p(0),\ p(1),\ p(2),\ p(3)));}}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keywordflow}{return}\ di;}
\DoxyCodeLine{00353\ \ \ \}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \textcolor{comment}{//\ ad\ a\ new\ primal\ vertex\ and\ return\ the\ index}}
\DoxyCodeLine{00356\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structpdmesh_ab9462a15f39417294a39701f846af81e}{add\_primal}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Vec4>\ \&hs)\ \{}
\DoxyCodeLine{00357\ \ \ \ \ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}.push\_back(hs);}
\DoxyCodeLine{00358\ \ \ \ \ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}.push\_back(std::vector<pdedge>());}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{comment}{//\ py::print(FORMAT("{}add\ primal\ \{\}:\ (\{\},\ \{\},\ \{\},\ \{\})"{},}}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ padj.size()\ -\/\ 1,\ hs(0),\ hs(1),\ hs(2),\ hs(3)));}}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{int})\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}.size()\ -\/\ 1;}
\DoxyCodeLine{00362\ \ \ \}}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ \textcolor{comment}{//\ make\ sure\ the\ order\ of\ dadj[di]\ is\ correct\ if\ dadj[di].size()\ ==\ 3}}
\DoxyCodeLine{00365\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structpdmesh_a1ac5b61ecff9135bf9797637259804d7}{fix\_order}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&di)\ \{}
\DoxyCodeLine{00366\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_a4d6e03343bec9e78936aade4743eebeb}{contains\_idx}}(di))}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}fix\_order\ called\ with\ invalid\ index"{}});}
\DoxyCodeLine{00369\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di].size()\ !=\ 3)}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][0].pj\ !=\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][1].pi)}
\DoxyCodeLine{00375\ \ \ \ \ \ \ std::swap(\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][1],\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][2]);}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][0].pj\ !=\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][1].pi\ ||}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][1].pj\ !=\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][2].pi\ ||}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][2].pj\ !=\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][0].pi)}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}dual\ edges\ adjacent\ in\ dadj\ do\ not\ form\ cycle"{}});}
\DoxyCodeLine{00382\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{comment}{//\ auto\ \&a\ =\ pvert[dadj[di][0].pi];}}
\DoxyCodeLine{00385\ \ \ \ \ \textcolor{comment}{//\ auto\ \&b\ =\ pvert[dadj[di][1].pi];}}
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{comment}{//\ auto\ \&c\ =\ pvert[dadj[di][2].pi];}}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{comment}{//\ dvert[di]\ =}}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{comment}{//\ \ \ \{}}
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ -\/a(\{1,2,3\}).cross(b(\{1,2,3\})).dot(c(\{1,2,3\})),}}
\DoxyCodeLine{00391\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ a(\{2,3,0\}).cross(b(\{2,3,0\})).dot(c(\{2,3,0\})),}}
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ -\/a(\{3,0,1\}).cross(b(\{3,0,1\})).dot(c(\{3,0,1\})),}}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ a(\{0,1,2\}).cross(b(\{0,1,2\})).dot(c(\{0,1,2\}))}}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{comment}{//\ \ \ \};}}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00397\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di](3)\ <=\ 1e-\/9)\ \{}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\mbox{\hyperlink{common_8hpp_ac8dc47e3b39c930caed4bfd05b4ba805}{FORMAT}}(\textcolor{stringliteral}{"{}halfspaces\ in\ dual\ intersection\ vertex\ \{\},\ intersect\ of\ primals\ \{\},\ \{\},\ \{\}\ not\ geometrically\ ordered:\ det\ =\ \{\}"{}},}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ di,\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][0].pi,\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][1].pi,\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di][2].pi,\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di](3)));}
\DoxyCodeLine{00400\ \ \ \ \ \}}
\DoxyCodeLine{00401\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \textcolor{comment}{//\ find\ how\ far\ inside\ /\ outside\ of\ the\ halfspace\ corresponding\ to\ pi\ the\ dual\ point\ di\ is}}
\DoxyCodeLine{00407\ \ \ \textcolor{comment}{//\ negative\ if\ inside,\ positive\ outside}}
\DoxyCodeLine{00408\ \ \ T\ \mbox{\hyperlink{structpdmesh_acfef7966ba5467ec2cf1c7645e38412d}{hs\_error}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&pi,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&di)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[pi].dot(\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di])\ /\ (\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di](3)\ *\ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[pi].head(3).norm());}
\DoxyCodeLine{00410\ \ \ \}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \textcolor{comment}{//\ check\ whether\ halfspace\ defined\ by\ pi\ contains\ dual\ point\ di}}
\DoxyCodeLine{00413\ \ \ \textcolor{comment}{//\ if\ di\ is\ not\ a\ valid\ dual\ index,\ return\ default\_return}}
\DoxyCodeLine{00414\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structpdmesh_a1731a4080909ec3fc1e4ee86c734191f}{contains}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&pi,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&di)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00415\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00416\ \ \ \ \ \textcolor{keywordflow}{if}\ (pi\ <\ 0\ ||\ pi\ >=\ \mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}()\ ||\ !\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_a4d6e03343bec9e78936aade4743eebeb}{contains\_idx}}(di))}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}called\ contains()\ with\ invalid\ points"{}});}
\DoxyCodeLine{00418\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00419\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[pi].dot(\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di])\ <=\ 0;}
\DoxyCodeLine{00420\ \ \ \}}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \textcolor{comment}{//\ find\ the\ (index\ of\ the)\ dual\ point\ which\ has\ largest\ inner\ product\ with\ d}}
\DoxyCodeLine{00423\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structpdmesh_abb024a68b6090c689178ce4f775e1da1}{extremal\_dual}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Vec3>\ \&d,\ \textcolor{keywordtype}{bool}\ brute\_force=\textcolor{keyword}{false},\ \textcolor{keywordtype}{int}\ hint\ =\ -\/1,\ \textcolor{keywordtype}{bool}\ debug=\textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordtype}{int}\ res\ =\ (hint\ >=\ 0\ ?\ hint\ :\ *\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_af7862f1c2f328beb6eb7e0efbd042a2b}{begin\_idx}}());}
\DoxyCodeLine{00425\ \ \ \ \ T\ maxval\ =\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[res].head(3).dot(d)\ /\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[res](3),\ val;}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keywordflow}{if}\ (brute\_force)\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_af7862f1c2f328beb6eb7e0efbd042a2b}{begin\_idx}}();\ it\ !=\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_a75e1c86b7cf779c494f74d3c8708f105}{end\_idx}}();\ ++it)\ \{}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ di\ =\ *it;}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ val\ =\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di].head(3).dot(d)\ /\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di](3);}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (val\ >\ maxval)\ \{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ res\ =\ di;}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ maxval\ =\ val;}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00436\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ tcnt\ =\ 0;}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ optimze\ this\ value\ or\ at\ least\ make\ it\ accessible}}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ eps\ =\ 1e-\/5;}
\DoxyCodeLine{00441\ \ \ \ \ \ \ }
\DoxyCodeLine{00442\ \ \ \ \ \ \ \textcolor{comment}{//\ traverse\ mesh\ to\ find\ extremal\ point}}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \mbox{\hyperlink{structpdmesh_a90490d62b74b97a4d91a3cfb7e8fa4e1}{used}}.\mbox{\hyperlink{classreusable__used__array_a2c3f88fc8155d148aade75d679486af7}{reset}}();}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \textcolor{comment}{//std::priority\_queue<std::pair<T,\ int>>\ q;}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ std::deque<std::pair<T,\ int>>\ q;}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \mbox{\hyperlink{structpdmesh_a90490d62b74b97a4d91a3cfb7e8fa4e1}{used}}.\mbox{\hyperlink{classreusable__used__array_a65673668d6645b5291428e5f954ef297}{mark}}(res);}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \textcolor{comment}{//q.push(\{maxval,\ res\});}}
\DoxyCodeLine{00448\ \ \ \ \ \ \ q.push\_back(\{maxval,\ res\});}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (!q.empty())\ \{}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \textcolor{comment}{//auto\ [v,\ di]\ =\ q.top();\ q.pop();}}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ [v,\ di]\ =\ q.back();\ q.pop\_back();}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ tcnt++;}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ don't\ continue\ from\ vertices\ further\ back}}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ (significantly\_less<T>(v,\ maxval,\ eps,\ eps))\ \{}}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ //\ py::print(FORMAT("{}break\ traverse\ because\ \{\}\ <<\ \{\},\ usedcnt\ =\ \{\}"{},\ v,\ maxval,\ used.ctr));}}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ break;}}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ go\ over\ neighbors\ and\ push\ them\ if\ they\ are\ not\ too\ far\ back\ and\ not\ already\ visited}}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&e\ :\ \mbox{\hyperlink{structpdmesh_af422ad89788280e8b556f2a65e6504b8}{dneigh}}(di))\ \{}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ val\ =\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.dj].head(3).dot(d)\ /\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.dj](3);}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{common_8hpp_a6634f8dddfe113467c24a5d2baa0f9e3}{significantly\_less<T>}}(val,\ maxval,\ eps,\ eps)\ \&\&\ !\mbox{\hyperlink{structpdmesh_a90490d62b74b97a4d91a3cfb7e8fa4e1}{used}}.\mbox{\hyperlink{classreusable__used__array_a9b366c018d39e8daf42511f45859be89}{check}}(e.dj))\ \{}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpdmesh_a90490d62b74b97a4d91a3cfb7e8fa4e1}{used}}.\mbox{\hyperlink{classreusable__used__array_a65673668d6645b5291428e5f954ef297}{mark}}(e.dj);}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//q.push(\{val,\ e.dj\});}}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (val\ >\ maxval)}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q.push\_back(\{val,\ e.dj\});}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q.push\_front(\{val,\ e.dj\});}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ we\ found\ new\ max,\ store\ it}}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (val\ >\ maxval)\ \{}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ maxval\ =\ val;}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ e.dj;}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}tcnt:"{}},\ tcnt,\ \textcolor{stringliteral}{"{}pqlen:"{}},\ q.size());}
\DoxyCodeLine{00482\ \ \ \ \ \}}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&e\ :\ \mbox{\hyperlink{structpdmesh_af422ad89788280e8b556f2a65e6504b8}{dneigh}}(res))\ \{}
\DoxyCodeLine{00485\ \ \ \ \ \ \ val\ =\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.dj].head(3).dot(d)\ /\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.dj](3);}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (val\ >\ maxval)}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}extremal\ dual\ is\ not\ locally\ extremal"{}});}
\DoxyCodeLine{00488\ \ \ \ \ \}}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00491\ \ \ \}}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \textcolor{comment}{//\ find\ the\ (index\ of\ the)\ primal\ point\ which\ is\ first\ cut\ off\ by\ the\ plane\ with\ normal\ d\ when\ translating\ it}}
\DoxyCodeLine{00494\ \ \ \textcolor{comment}{//\ return\ \{pi,\ <d,\ last\ (dual)\ vertex\ of\ pi\ cut\ off>\}}}
\DoxyCodeLine{00495\ \ \ std::pair<int,\ T>\ \mbox{\hyperlink{structpdmesh_af66987b9ee96dfe27bf44a1808557797}{closest\_primal}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Vec3>\ \&d)\ \{}
\DoxyCodeLine{00496\ \ \ \ \ }
\DoxyCodeLine{00497\ \ \ \ \ T\ maxval\ =\ -\/std::numeric\_limits<T>::infinity(),\ val;}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keywordtype}{int}\ res\ =\ -\/1;}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ pi\ =\ 6;\ pi\ <\ (int)\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}.size();\ ++pi)\ \{}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[pi].size()\ ==\ 0)}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00504\ \ \ \ \ \ \ }
\DoxyCodeLine{00505\ \ \ \ \ \ \ val\ =\ std::numeric\_limits<T>::infinity();}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&e\ :\ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[pi])\ \{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ val\ =\ std::min(val,\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.di].head(3).dot(d)\ /\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.di](3));}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (val\ <\ maxval)}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ }
\DoxyCodeLine{00512\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (val\ >\ maxval)\ \{}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ res\ =\ pi;}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ maxval\ =\ val;}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00516\ \ \ \ \ \}}
\DoxyCodeLine{00517\ \ \ \ \ }
\DoxyCodeLine{00518\ \ \ \ \ \textcolor{keywordflow}{return}\ \{res,\ maxval\};}
\DoxyCodeLine{00519\ \ \ \}}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \textcolor{comment}{//\ get\ neighbors\ of\ primal\ index\ pi\ (as\ edges\ e\ with\ e.pi\ ==\ pi)}}
\DoxyCodeLine{00522\ \ \ \textcolor{keyword}{const}\ std::vector<pdedge>\&\ \mbox{\hyperlink{structpdmesh_ac42c1dbe5977a7d4f04f4f07b6084e15}{pneigh}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&pi)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00523\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00524\ \ \ \ \ \textcolor{keywordflow}{if}\ (pi\ <\ 0\ ||\ pi\ >=\ \mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}())}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}called\ pneigh\ with\ invalid\ index"{}});}
\DoxyCodeLine{00526\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00527\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[pi];}
\DoxyCodeLine{00528\ \ \ \}}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \textcolor{comment}{//\ get\ neighbors\ of\ dual\ index\ di\ (as\ edges\ e\ with\ e.di\ ==\ di)}}
\DoxyCodeLine{00531\ \ \ \textcolor{keyword}{const}\ std::vector<pdedge>\&\ \mbox{\hyperlink{structpdmesh_af422ad89788280e8b556f2a65e6504b8}{dneigh}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&di)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00532\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_a4d6e03343bec9e78936aade4743eebeb}{contains\_idx}}(di))}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}called\ pneigh\ with\ invalid\ index"{}});}
\DoxyCodeLine{00535\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00536\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}[di];}
\DoxyCodeLine{00537\ \ \ \}}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00539\ \ \ std::string\ \mbox{\hyperlink{structpdmesh_a4c041738e27d41d88f0d6039ef88877d}{repr}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00540\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{00541\ \ \ \ \ ss\ <<\ \textcolor{stringliteral}{"{}PDMesh(pcnt\ =\ "{}}\ <<\ \mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}()\ <<\ \textcolor{stringliteral}{"{},\ dcnt\ =\ "{}}\ <<\ \mbox{\hyperlink{structpdmesh_a6cbf65bd6c1df0ba4c20af5411d8f0f3}{dcnt}}()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00542\ \ \ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{00543\ \ \ \}}
\DoxyCodeLine{00544\ }
\DoxyCodeLine{00545\ \ \ std::vector<Vec4>\ \mbox{\hyperlink{structpdmesh_a56a35825ae7c64e2571bd758179f6947}{primal\_poly}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&pi)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00546\ \ \ \ \ std::vector<Vec4>\ res;}
\DoxyCodeLine{00547\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&e\ :\ \mbox{\hyperlink{structpdedge_acd41f3afab4bfdbdf041ac363fa21860}{pdedge::order\_cycle<false>}}(\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[pi]))\ \{}
\DoxyCodeLine{00548\ \ \ \ \ \ \ res.push\_back(\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.di]);}
\DoxyCodeLine{00549\ \ \ \ \ \}}
\DoxyCodeLine{00550\ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00551\ \ \ \}}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structpdmesh_abb3e165068d82f1d4ef970099c95da87}{check\_integrity}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00554\ \ \ \ \ \textcolor{keywordtype}{bool}\ res\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}}.\mbox{\hyperlink{classdvector_ac98dd66e2059aed3405ff7aaeeb5949b}{size}}()\ !=\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}.\mbox{\hyperlink{classdvector_ac98dd66e2059aed3405ff7aaeeb5949b}{size}}())\ \{}
\DoxyCodeLine{00557\ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}dadj\ and\ dvert\ have\ different\ sizes"{}});}
\DoxyCodeLine{00558\ \ \ \ \ \ \ res\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00559\ \ \ \ \ \}}
\DoxyCodeLine{00560\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}.size()\ !=\ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}.size())\ \{}
\DoxyCodeLine{00561\ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}padj\ and\ pvert\ have\ different\ sizes"{}});}
\DoxyCodeLine{00562\ \ \ \ \ \ \ res\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00563\ \ \ \ \ \}}
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00565\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&v\ :\ \mbox{\hyperlink{structpdmesh_aec97021eaf975098b763c6b142026ddb}{dadj}})\ \{}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \textcolor{comment}{//\ check\ dual\ face\ size}}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (v.size()\ !=\ 3)\ \{}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}non-\/triangular\ dual\ face\ found:"{}},\ v);}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ res\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \ \ \ \ \ \ \textcolor{comment}{//\ check\ dual\ face\ orientation\ /\ order}}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ first\_pi,\ prev\_pj;}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ first\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&e\ :\ v)\ \{}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (first)\ \{}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ first\_pi\ =\ e.pi;}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ first\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (e.pi\ !=\ prev\_pj)\ \{}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}incorrectly\ ordered\ or\ oriented\ dual\ face\ found:"{}},\ v);}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ prev\_pj\ =\ e.pj;}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (first\_pi\ !=\ prev\_pj)\ \{}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}incorrectly\ ordered\ dual\ face\ found:\ "{}},\ v);}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ res\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00591\ \ \ \ \ \}}
\DoxyCodeLine{00592\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&v\ :\ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}})\ \{}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \textcolor{comment}{//\ check\ primal\ face\ size}}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (v.size()\ ==\ 1\ ||\ v.size()\ ==\ 2)\ \{}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}degenerated\ primal\ face\ found:"{}},\ v);}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ res\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00598\ \ \ \ \ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ pi\ =\ 0;\ pi\ <\ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}.size();\ ++pi)}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ dit\ =\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}.\mbox{\hyperlink{classdvector_af7862f1c2f328beb6eb7e0efbd042a2b}{begin\_idx}}();\ dit\ !=\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}.\mbox{\hyperlink{classdvector_a75e1c86b7cf779c494f74d3c8708f105}{end\_idx}}();\ ++dit)\ \{}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ di\ =\ *dit;}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ v\ =\ \mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[pi];}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ dv\ =\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di];}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ neigh\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&e\ :\ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[pi])}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (di\ ==\ e.di)}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ \ \ neigh\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ T\ dd\ =\ v.dot(dv);}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!neigh\ \&\&\ dd\ >\ 1e-\/9)\ \{}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ py::print(\mbox{\hyperlink{common_8hpp_ac8dc47e3b39c930caed4bfd05b4ba805}{FORMAT}}(\textcolor{stringliteral}{"{}convexity\ violation\ by\ \{\}\ @\ primal\ \{\}\ (\{\},\ \{\},\ \{\},\ \{\}),\ dual\ \{\}\ (\{\},\ \{\},\ \{\},\ \{\})"{}},}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dd,\ pi,\ v(0),\ v(1),\ v(2),\ v(3),\ di,\ dv(0),\ dv(1),\ dv(2),\ dv(3)));}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \ \ res\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00618\ \ \ \ \ }
\DoxyCodeLine{00619\ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00620\ \ \ \}}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structpdmesh_ad0260a8d385485a8f25c05ffeb177610}{write\_ply}}(std::string\ path)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00623\ \ \ \ \ std::ofstream\ s(path);}
\DoxyCodeLine{00624\ \ \ \ \ s\ <<\ std::setprecision(10);}
\DoxyCodeLine{00625\ \ \ \ \ s\ <<\ \textcolor{stringliteral}{"{}ply"{}}\ <<\ std::endl}
\DoxyCodeLine{00626\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}format\ ascii\ 1.0"{}}\ <<\ std::endl}
\DoxyCodeLine{00627\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}element\ vertex\ "{}}\ <<\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}.\mbox{\hyperlink{classdvector_ad63d3b9d1e699327918980fe923ca8e6}{capacity}}()\ <<\ std::endl}
\DoxyCodeLine{00628\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}property\ float\ x"{}}\ <<\ std::endl}
\DoxyCodeLine{00629\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}property\ float\ y"{}}\ <<\ std::endl}
\DoxyCodeLine{00630\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}property\ float\ z"{}}\ <<\ std::endl}
\DoxyCodeLine{00631\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}element\ face\ "{}}\ <<\ \mbox{\hyperlink{structpdmesh_a920c210918b837f420832b98c52e3d60}{pcnt}}()\ <<\ std::endl}
\DoxyCodeLine{00632\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}property\ list\ uint\ uint\ vertex\_indices"{}}\ <<\ std::endl}
\DoxyCodeLine{00633\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}end\_header"{}}\ <<\ std::endl;}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&v\ :\ \mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}.\mbox{\hyperlink{classdvector_a84ec43150f45e4140295de8a3fda10ef}{data}})\ \{}
\DoxyCodeLine{00635\ \ \ \ \ \ \ s\ <<\ std::clamp(v[0]\ /\ v[3],\ (T)-\/1e30,\ (T)1e30)\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ <<\ std::clamp(v[1]\ /\ v[3],\ (T)-\/1e30,\ (T)1e30)\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ <<\ std::clamp(v[2]\ /\ v[3],\ (T)-\/1e30,\ (T)1e30)\ <<\ std::endl;}
\DoxyCodeLine{00638\ \ \ \ \ \}}
\DoxyCodeLine{00639\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&es\ :\ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}})\ \{}
\DoxyCodeLine{00640\ \ \ \ \ \ \ s\ <<\ es.size();}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&e\ :\ \mbox{\hyperlink{structpdedge_acd41f3afab4bfdbdf041ac363fa21860}{pdedge::order\_cycle<false>}}(es))}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ s\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ e.di;}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (std::runtime\_error\ \&ex)\ \{}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}WARNING:\ failed\ to\ order\_cycle\ in\ write\_ply"{}});}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&e\ :\ es)}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ s\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ e.di;}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00649\ \ \ \ \ \ \ s\ <<\ std::endl;}
\DoxyCodeLine{00650\ \ \ \ \ \}}
\DoxyCodeLine{00651\ \ \ \}}
\DoxyCodeLine{00652\ }
\DoxyCodeLine{00653\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structpdmesh_a3858322db944f1d7c1eb0a7d4f22f5ee}{order\_all}}()\ \{}
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ (int)\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}.size();\ ++i)\ \{}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[i]\ =\ \mbox{\hyperlink{structpdedge_acd41f3afab4bfdbdf041ac363fa21860}{pdedge::order\_cycle<false>}}(\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[i]);}
\DoxyCodeLine{00656\ \ \ \ \ \}}
\DoxyCodeLine{00657\ \ \ \}}
\DoxyCodeLine{00658\ }
\DoxyCodeLine{00659\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structpdmesh_a5d56a224383a95afae67c0f1af2d3f5a}{bind}}(py::module\_\ \&m)\ \{}
\DoxyCodeLine{00660\ \ \ \ \ py::class\_<pdmesh<T>>(m,\ (\textcolor{stringliteral}{"{}PDMesh\_"{}}\ +\ \mbox{\hyperlink{structtype__name_ad7cf8dab8ba9a198318e79bbf1747844}{type\_name<T>::value}}()).c\_str())}
\DoxyCodeLine{00661\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}\_\_repr\_\_"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::repr}})}
\DoxyCodeLine{00662\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}check\_integrity"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::check\_integrity}})}
\DoxyCodeLine{00663\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}primal\_poly"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::primal\_poly}})}
\DoxyCodeLine{00664\ \ \ \ \ \ \ .def\_property\_readonly(\textcolor{stringliteral}{"{}pcnt"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::pcnt}})}
\DoxyCodeLine{00665\ \ \ \ \ \ \ .def\_property\_readonly(\textcolor{stringliteral}{"{}dcnt"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::dcnt}})}
\DoxyCodeLine{00666\ \ \ \ \ \ \ .def\_readonly(\textcolor{stringliteral}{"{}padj"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::padj}})}
\DoxyCodeLine{00667\ \ \ \ \ \ \ .def\_property\_readonly(\textcolor{stringliteral}{"{}dadj"{}},}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdmesh}{pdmesh<T>}}\ *m)\{\ \textcolor{keywordflow}{return}\ m-\/>dadj.data;\})}
\DoxyCodeLine{00669\ \ \ \ \ \ \ .def\_readonly(\textcolor{stringliteral}{"{}pvert"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::pvert}})}
\DoxyCodeLine{00670\ \ \ \ \ \ \ .def\_property\_readonly(\textcolor{stringliteral}{"{}dvert"{}},}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\textcolor{keyword}{const}\ \mbox{\hyperlink{structpdmesh}{pdmesh<T>}}\ *m)\{\ \textcolor{keywordflow}{return}\ m-\/>dvert.data;\})}
\DoxyCodeLine{00672\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}extremal\_dual"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::extremal\_dual}},}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ \ py::arg(\textcolor{stringliteral}{"{}d"{}}),\ py::arg(\textcolor{stringliteral}{"{}brute\_force"{}})=\textcolor{keyword}{false},}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ \ \ py::arg(\textcolor{stringliteral}{"{}hint"{}})=-\/1,\ py::arg(\textcolor{stringliteral}{"{}debug"{}})=\textcolor{keyword}{false})}
\DoxyCodeLine{00675\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}closest\_primal"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::closest\_primal}})}
\DoxyCodeLine{00676\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}write\_ply"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::write\_ply}})}
\DoxyCodeLine{00677\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}order\_all"{}},\ \&\mbox{\hyperlink{structpdmesh}{pdmesh<T>::order\_all}});}
\DoxyCodeLine{00678\ \ \ \}}
\DoxyCodeLine{00679\ \};}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T\ =\ \textcolor{keywordtype}{double}>}
\DoxyCodeLine{00682\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classhalfspace__intersection}{halfspace\_intersection}}}
\DoxyCodeLine{00683\ \{}
\DoxyCodeLine{00684\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00685\ \ \ \textcolor{keyword}{typedef}\ Eigen::Vector3<T>\ \mbox{\hyperlink{classhalfspace__intersection_a1f42560747048ee440fd8fd6ec63d747}{Vec3}};}
\DoxyCodeLine{00686\ \ \ \textcolor{keyword}{typedef}\ Eigen::Vector4<T>\ \mbox{\hyperlink{classhalfspace__intersection_acc2fa1fb9fff3e52ad403ee1155c93a7}{Vec4}};}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ }
\DoxyCodeLine{00689\ \ \ \mbox{\hyperlink{structpdmesh}{pdmesh<T>}}\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}};}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \mbox{\hyperlink{classreusable__used__array}{reusable\_used\_array<>}}\ \mbox{\hyperlink{classhalfspace__intersection_ac443fb7d9fb7f66953fc7c277babe35b}{used}};}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00694\ \ \ std::shared\_ptr<timer>\ time\ =\ NULL;}
\DoxyCodeLine{00695\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_find\_cut\ =\ -\/1,\ idx\_time\_partition\ =\ -\/1,\ idx\_time\_cycledec\ =\ -\/1,\ idx\_time\_add\ =\ -\/1,\ idx\_time\_remove\ =\ -\/1;}
\DoxyCodeLine{00696\ }
\DoxyCodeLine{00697\ \ \ \textcolor{keywordtype}{int}\ remove\_count\ =\ 0;}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \ \ \textcolor{keywordtype}{void}\ setup\_timer()\ \{}
\DoxyCodeLine{00700\ \ \ \ \ \textcolor{keywordflow}{if}\ (!time)}
\DoxyCodeLine{00701\ \ \ \ \ \ \ time\ =\ std::make\_shared<timer>();}
\DoxyCodeLine{00702\ \ \ \ \ idx\_time\_find\_cut\ =\ time-\/>get\_index\_from\_name(\textcolor{stringliteral}{"{}halfspace\_intersection.find\_cut"{}});}
\DoxyCodeLine{00703\ \ \ \ \ idx\_time\_partition\ =\ time-\/>get\_index\_from\_name(\textcolor{stringliteral}{"{}halfspace\_intersection.partition"{}});}
\DoxyCodeLine{00704\ \ \ \ \ idx\_time\_cycledec\ =\ time-\/>get\_index\_from\_name(\textcolor{stringliteral}{"{}halfspace\_intersection.cycledec"{}});}
\DoxyCodeLine{00705\ \ \ \ \ idx\_time\_add\ =\ time-\/>get\_index\_from\_name(\textcolor{stringliteral}{"{}halfspace\_intersection.add"{}});}
\DoxyCodeLine{00706\ \ \ \ \ idx\_time\_remove\ =\ time-\/>get\_index\_from\_name(\textcolor{stringliteral}{"{}halfspace\_intersection.remove"{}});}
\DoxyCodeLine{00707\ \ \ \}}
\DoxyCodeLine{00708\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00710\ }
\DoxyCodeLine{00711\ \ \ \textcolor{comment}{//\ start\ with\ cuboid\ domain\ defined\ by\ lower\ and\ upper\ bounds}}
\DoxyCodeLine{00712\ \ \ \mbox{\hyperlink{classhalfspace__intersection_a2f620008924b955858f8ad4978e71447}{halfspace\_intersection}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Vec3>\ \&lb\ =\ \mbox{\hyperlink{classhalfspace__intersection_a1f42560747048ee440fd8fd6ec63d747}{Vec3}}(0,0,0),}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<const\ Vec3>\ \&ub\ =\ \mbox{\hyperlink{classhalfspace__intersection_a1f42560747048ee440fd8fd6ec63d747}{Vec3}}(1,1,1))\ :}
\DoxyCodeLine{00714\ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}(\mbox{\hyperlink{structpdmesh}{pdmesh}}<T>::cube(lb,\ ub)),\ \mbox{\hyperlink{classhalfspace__intersection_ac443fb7d9fb7f66953fc7c277babe35b}{used}}(8)\ \{\ \}}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \ \ \mbox{\hyperlink{classhalfspace__intersection_a7d5bf007b9a888fefde4183174657b55}{halfspace\_intersection}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Vec3>\ \&lb,}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<const\ Vec3>\ \&ub,}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<T,\ Eigen::Dynamic,\ 4,\ Eigen::RowMajor>>\ \&hss)\ :}
\DoxyCodeLine{00719\ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection}{halfspace\_intersection}}(lb,\ ub)\ \{}
\DoxyCodeLine{00720\ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_a3fbfe1baad6f2ab33338b1030d3ea645}{add\_halfspaces}}(hss);}
\DoxyCodeLine{00721\ \ \ \}}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classhalfspace__intersection_a3fbfe1baad6f2ab33338b1030d3ea645}{add\_halfspaces}}(\textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<T,\ Eigen::Dynamic,\ 4,\ Eigen::RowMajor>>\ \&hss)\ \{}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&hs\ :\ hss.rowwise())}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_a8974ffe52c0d11ba961beb782c85eb8f}{add\_halfspace}}(hs);}
\DoxyCodeLine{00726\ \ \ \}}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classhalfspace__intersection_a8974ffe52c0d11ba961beb782c85eb8f}{add\_halfspace}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Vec4>\ \&hs,\ \textcolor{keywordtype}{int}\ hint\ =\ -\/1)\ \{}
\DoxyCodeLine{00729\ \textcolor{preprocessor}{\#ifdef\ EXPENSIVE\_DEBUG\_CHECKS}}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_abb3e165068d82f1d4ef970099c95da87}{check\_integrity}}())}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}mesh\ integrity\ broken\ before\ adding\ new\ halfspace"{}});}
\DoxyCodeLine{00732\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{keywordflow}{if}\ (idx\_time\_find\_cut\ <\ 0)}
\DoxyCodeLine{00736\ \ \ \ \ \ \ setup\_timer();}
\DoxyCodeLine{00737\ }
\DoxyCodeLine{00738\ \ \ \ \ time-\/>start\_section(idx\_time\_find\_cut);}
\DoxyCodeLine{00739\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \ \ \ \ \textcolor{comment}{//\ mesh.write\_ply("{}meshdump\_pre.ply"{});}}
\DoxyCodeLine{00742\ }
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{comment}{//\ increment\ used\_ctr\ to\ effectively\ get\ fresh\ used\ array}}
\DoxyCodeLine{00744\ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_ac443fb7d9fb7f66953fc7c277babe35b}{used}}.\mbox{\hyperlink{classreusable__used__array_a2c3f88fc8155d148aade75d679486af7}{reset}}();}
\DoxyCodeLine{00745\ }
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{comment}{//\ add\ new\ primal}}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keywordtype}{int}\ pi\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_ab9462a15f39417294a39701f846af81e}{add\_primal}}(hs);}
\DoxyCodeLine{00748\ }
\DoxyCodeLine{00749\ \ \ \ \ \textcolor{comment}{//\ find\ best\ dual\ hint\ from\ primal\ hint}}
\DoxyCodeLine{00750\ \ \ \ \ \textcolor{keywordtype}{int}\ dhint\ =\ -\/1;}
\DoxyCodeLine{00751\ \ \ \ \ \textcolor{keywordflow}{if}\ (hint\ >=\ 0\ \&\&\ hint\ <\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}.size()\ \&\&\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_ac42c1dbe5977a7d4f04f4f07b6084e15}{pneigh}}(hint).size()\ >\ 0)\ \{}
\DoxyCodeLine{00752\ \ \ \ \ \ \ T\ bval\ =\ -\/std::numeric\_limits<T>::infinity();}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&e\ :\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_ac42c1dbe5977a7d4f04f4f07b6084e15}{pneigh}}(hint))\ \{}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ T\ val\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.di].head(3).dot(hs.head(3))\ /\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.di][3];}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (val\ >\ bval)\ \{}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ bval\ =\ val;}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ dhint\ =\ e.di;}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00760\ \ \ \ \ \}}
\DoxyCodeLine{00761\ \ \ \ \ }
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{comment}{//\ find\ dual\ vertex\ furthest\ in\ direction\ of\ halfspace\ normal}}
\DoxyCodeLine{00763\ \ \ \ \ \textcolor{keywordtype}{int}\ di\_start\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_abb024a68b6090c689178ce4f775e1da1}{extremal\_dual}}(hs.head(3),\ \textcolor{keyword}{false},\ dhint);}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ \ \ \textcolor{comment}{//\ find\ best\ hint\ for\ next\ time\ (since\ there\ are\ only\ 3\ dual\ neighbors\ but\ there\ may\ be\ many\ primal,\ it\ makes\ sense\ to\ look\ for\ the\ one\ with\ smallest\ degree)}}
\DoxyCodeLine{00766\ \ \ \ \ \textcolor{keywordtype}{int}\ phint\ =\ -\/1;}
\DoxyCodeLine{00767\ \ \ \ \ \{}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ best\ =\ 1e9;}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&e\ :\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_af422ad89788280e8b556f2a65e6504b8}{dneigh}}(di\_start))\ \{}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_ac42c1dbe5977a7d4f04f4f07b6084e15}{pneigh}}(e.pi).size()\ <\ best)\ \{}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ phint\ =\ e.pi;}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \ best\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_ac42c1dbe5977a7d4f04f4f07b6084e15}{pneigh}}(e.pi).size();}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00775\ \ \ \ \ \}}
\DoxyCodeLine{00776\ }
\DoxyCodeLine{00777\ }
\DoxyCodeLine{00778\ \textcolor{preprocessor}{\#ifdef\ EXPENSIVE\_DEBUG\_CHECKS}}
\DoxyCodeLine{00779\ \ \ \ \ \textcolor{keywordtype}{int}\ di\_start\_brute\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_abb024a68b6090c689178ce4f775e1da1}{extremal\_dual}}(hs.head(3),\ \textcolor{keyword}{true});}
\DoxyCodeLine{00780\ \ \ \ \ T\ v\_trav\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start].head(3).dot(hs.head(3))\ /\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start][3];}
\DoxyCodeLine{00781\ \ \ \ \ T\ v\_brute\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start\_brute].head(3).dot(hs.head(3))\ /\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start\_brute][3];}
\DoxyCodeLine{00782\ \ \ \ \ }
\DoxyCodeLine{00783\ \ \ \ \ \textcolor{keywordflow}{if}\ (v\_trav\ !=\ v\_brute)}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\mbox{\hyperlink{common_8hpp_ac8dc47e3b39c930caed4bfd05b4ba805}{FORMAT}}(\textcolor{stringliteral}{"{}extremal\_dual\ incorrect\ -\/\ trav:\ \{\}\ (\{\},\ \{\},\ \{\},\ \{\})\ dist\ (\{\}),\ "{}}}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}brute:\ \{\}\ (\{\},\ \{\},\ \{\},\ \{\})\ dist\ (\{\}),\ integrity:\ \{\}"{}},}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ di\_start,\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start](0),\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start](1),\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start](2),\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start](3),\ v\_trav,}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ di\_start\_brute,\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start\_brute](0),\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start\_brute](1),\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start\_brute](2),\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[di\_start\_brute](3),\ v\_brute,}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_abb3e165068d82f1d4ef970099c95da87}{check\_integrity}}()));}
\DoxyCodeLine{00789\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ }
\DoxyCodeLine{00792\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a1731a4080909ec3fc1e4ee86c734191f}{contains}}(pi,\ di\_start))}
\DoxyCodeLine{00793\ \ \ \ \ \ \ di\_start\ =\ -\/1;}
\DoxyCodeLine{00794\ }
\DoxyCodeLine{00795\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00796\ \ \ \ \ time-\/>end\_section();}
\DoxyCodeLine{00797\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00798\ }
\DoxyCodeLine{00799\ \ \ \ \ \textcolor{comment}{//\ if\ there\ is\ no\ point\ outside,\ the\ new\ halfspace\ does\ nothing}}
\DoxyCodeLine{00800\ \ \ \ \ \textcolor{keywordflow}{if}\ (di\_start\ <\ 0)\ \{}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \textcolor{comment}{//\ py::print("{}halfspace"{},\ pi,\ "{}completely\ contains\ domain"{});}}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ phint;}
\DoxyCodeLine{00803\ \ \ \ \ \}}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \textcolor{preprocessor}{\#ifdef\ DEBUG\_CHECKS}}
\DoxyCodeLine{00806\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a1731a4080909ec3fc1e4ee86c734191f}{contains}}(pi,\ di\_start))}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\mbox{\hyperlink{common_8hpp_ac8dc47e3b39c930caed4bfd05b4ba805}{FORMAT}}(\textcolor{stringliteral}{"{}mesh\ contains\ starting\ index\ \{\}\ which\ it\ shouldn't"{}},\ di\_start));}
\DoxyCodeLine{00808\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00809\ }
\DoxyCodeLine{00810\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00811\ \ \ \ \ time-\/>start\_section(idx\_time\_partition);}
\DoxyCodeLine{00812\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00813\ }
\DoxyCodeLine{00814\ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_ac443fb7d9fb7f66953fc7c277babe35b}{used}}.\mbox{\hyperlink{classreusable__used__array_a2c3f88fc8155d148aade75d679486af7}{reset}}();}
\DoxyCodeLine{00815\ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_ac443fb7d9fb7f66953fc7c277babe35b}{used}}.\mbox{\hyperlink{classreusable__used__array_a65673668d6645b5291428e5f954ef297}{mark}}(di\_start);}
\DoxyCodeLine{00816\ \ \ \ \ std::vector<int>\ remove\_di(\{di\_start\});\ \ \textcolor{comment}{//\ dual\ vertices\ that\ are\ cut\ off\ (contains(pi,\ *)\ is\ false)}}
\DoxyCodeLine{00817\ \ \ \ \ std::vector<pdedge>\ cross\_e;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ edges\ crossing\ from\ cut\ off\ part\ to\ remaining\ part\ (e.di\ is\ removed,\ e.dj\ is\ remaining)}}
\DoxyCodeLine{00818\ }
\DoxyCodeLine{00819\ \ \ \ \ \textcolor{comment}{//\ traverse\ set\ of\ cut\ off\ vertices\ and\ store\ the\ vertices\ and\ edges\ connecting\ them\ to\ the\ remaining\ part}}
\DoxyCodeLine{00820\ \ \ \ \ std::vector<int>\ q(\{di\_start\});}
\DoxyCodeLine{00821\ \ \ \ \ \textcolor{keywordflow}{while}\ (!q.empty())\ \{}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \textcolor{comment}{//\ int\ di\ =\ q.front();}}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \textcolor{comment}{//\ q.pop\_front();}}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ di\ =\ q.back();}
\DoxyCodeLine{00825\ \ \ \ \ \ \ q.pop\_back();}
\DoxyCodeLine{00826\ }
\DoxyCodeLine{00827\ \ \ \ \ \ \ \textcolor{comment}{//\ std::cout\ <<\ "{}visit\ "{}\ <<\ di\ <<\ std::endl;}}
\DoxyCodeLine{00828\ }
\DoxyCodeLine{00829\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&e\ :\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_af422ad89788280e8b556f2a65e6504b8}{dneigh}}(di))\ \{}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ignore\ already\ visited\ vertices}}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classhalfspace__intersection_ac443fb7d9fb7f66953fc7c277babe35b}{used}}.\mbox{\hyperlink{classreusable__used__array_a9b366c018d39e8daf42511f45859be89}{check}}(e.dj))}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a1731a4080909ec3fc1e4ee86c734191f}{contains}}(pi,\ e.dj))\ \{}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ e.dj\ is\ also\ cut\ off\ -\/>\ store\ and\ push\ onto\ queue}}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \ \ q.push\_back(e.dj);}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \ \ remove\_di.push\_back(e.dj);}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ mark\ used}}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_ac443fb7d9fb7f66953fc7c277babe35b}{used}}.\mbox{\hyperlink{classreusable__used__array_a65673668d6645b5291428e5f954ef297}{mark}}(e.dj);}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ e.dj\ is\ not\ cut\ off\ -\/>\ store\ the\ edge}}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ cross\_e.push\_back(e);}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00844\ }
\DoxyCodeLine{00845\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00846\ \ \ \ \ \}}
\DoxyCodeLine{00847\ }
\DoxyCodeLine{00848\ \ \ \ \ \textcolor{comment}{//\ -\/\ remove\ cut\ dual\ vertices\ with\ all\ their\ edges}}
\DoxyCodeLine{00849\ \ \ \ \ \textcolor{comment}{//\ -\/\ add\ new\ dual\ vertices\ at\ intersections}}
\DoxyCodeLine{00850\ \ \ \ \ \textcolor{comment}{//\ -\/\ add\ new\ edges\ where\ cross\_e\ used\ to\ be\ (or\ update\ these\ instead\ of\ deleting)}}
\DoxyCodeLine{00851\ \ \ \ \ \textcolor{comment}{//\ -\/\ add\ new\ edges\ between\ the\ new\ vertices}}
\DoxyCodeLine{00852\ }
\DoxyCodeLine{00853\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00854\ \ \ \ \ time-\/>start\_section(idx\_time\_cycledec);}
\DoxyCodeLine{00855\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00856\ }
\DoxyCodeLine{00857\ \ \ \ \ std::vector<std::vector<pdedge>>\ cycles;}
\DoxyCodeLine{00858\ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \textcolor{comment}{//\ order\ the\ cut\ edges\ by\ primal\ indices\ (i.e.\ such\ that\ e[i].pj\ ==\ e[i+1].pi)}}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \textcolor{comment}{//cross\_e\ =\ pdedge::order\_cycle<true>(cross\_e);}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ cycles\ =\ \mbox{\hyperlink{structpdedge_a9002d65afab23cff6089ac414470f29a}{pdedge::cycle\_decomposition<true>}}(cross\_e);}
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00863\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cycles.size()\ !=\ 1)}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}WARNING:\ 1\ !=\ number\ of\ cycles:"{}},\ cycles.size());}
\DoxyCodeLine{00865\ }
\DoxyCodeLine{00866\ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (std::runtime\_error\ \&ex)\ \{}
\DoxyCodeLine{00867\ }
\DoxyCodeLine{00868\ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}cut\_verts:"{}},\ remove\_di);}
\DoxyCodeLine{00869\ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}cross\_e:"{}},\ cross\_e);}
\DoxyCodeLine{00870\ }
\DoxyCodeLine{00871\ }
\DoxyCodeLine{00872\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00873\ \ \ \ \ \ \ time-\/>end\_section();}
\DoxyCodeLine{00874\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ ex;}
\DoxyCodeLine{00876\ \ \ \ \ \}}
\DoxyCodeLine{00877\ }
\DoxyCodeLine{00878\ }
\DoxyCodeLine{00879\ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00881\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00882\ \ \ \ \ \ \ time-\/>start\_section(idx\_time\_add);}
\DoxyCodeLine{00883\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00884\ }
\DoxyCodeLine{00885\ \ \ \ \ \ \ \textcolor{comment}{//\ add\ new\ edges}}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&cross\_e\ :\ cycles)\ \{}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpdedge}{pdedge}}\ first\_e,\ prev\_e;}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ first\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&e\ :\ cross\_e)\ \{}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ calculate\ intersect\ of\ e\ and\ new\ halfspace}}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ i.e.\ the\ segment\ [mesh.dvert[e.di],\ mesh.dvert[e.dj]]}}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ with\ the\ plane\ with\ normal\ vector\ mesh.pvert[pi]\ (==\ hs)}}
\DoxyCodeLine{00893\ }
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_acc2fa1fb9fff3e52ad403ee1155c93a7}{Vec4}}\ dv;}
\DoxyCodeLine{00895\ }
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \&a\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[e.pi];}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \&b\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[e.pj];}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \&c\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a53a4bd5e522627505593ad24e64b7074}{pvert}}[pi];}
\DoxyCodeLine{00899\ }
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ T\ dt\ =\ a(\{0,1,2\}).cross(b(\{0,1,2\})).dot(c(\{0,1,2\}));}
\DoxyCodeLine{00901\ }
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::abs(dt)\ <\ 1e-\/5)\ \{}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ the\ determinant\ is\ small,\ the\ calculation\ of\ the\ intersect\ from\ 3\ halfplanes\ would\ be}}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ imprecise,\ so\ do\ an\ edge-\/plane\ intersection\ instead\ (this\ is\ not\ always\ used\ as\ it\ has}}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ it's\ own\ imprecision\ problems\ for\ very\ long\ edges\ like\ the\ ones\ on\ the\ boundary)}}
\DoxyCodeLine{00906\ }
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \&a2\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.di];}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \&b2\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a8bb5411bf7494cc74b1315b61de982dd}{dvert}}[e.dj];}
\DoxyCodeLine{00909\ }
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ <a\ +\ l\ *\ (b\ -\/\ a),\ hs>\ =\ 0}}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \ \ \ \ T\ l\ =\ std::clamp(hs.dot(a2)\ /\ hs.dot(a2\ -\/\ b2),\ (T)0.,\ (T)1.);}
\DoxyCodeLine{00912\ }
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \ \ \ \ dv\ =\ a2\ +\ l\ *\ (b2\ -\/\ a2);}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \ \ \ \ dv\ =\ \mbox{\hyperlink{classhalfspace__intersection_acc2fa1fb9fff3e52ad403ee1155c93a7}{Vec4}}(-\/a(\{1,2,3\}).cross(b(\{1,2,3\})).dot(c(\{1,2,3\}))\ /\ dt,}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a(\{2,3,0\}).cross(b(\{2,3,0\})).dot(c(\{2,3,0\}))\ /\ dt,}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/a(\{3,0,1\}).cross(b(\{3,0,1\})).dot(c(\{3,0,1\}))\ /\ dt,}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.0);}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00920\ }
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ run\ some\ iterations\ of\ cyclic\ projections\ to\ refine\ the\ result}}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ max\_its\ =\ 100;}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ T\ max\_err\ =\ 1e-\/9;}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ na\ =\ a.normalized();}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ nb\ =\ b.normalized();}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ nc\ =\ c.normalized();}
\DoxyCodeLine{00929\ }
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \ \ \ \ T\ err\ =\ std::numeric\_limits<T>::infinity(),\ d;}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ max\_its\ \&\&\ err\ >\ max\_err;\ ++i)\ \{}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ err\ =\ 0;}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ na.dot(dv);\ dv\ -\/=\ na\ *\ d;\ \ err\ =\ std::max(err,\ d);}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ nb.dot(dv);\ dv\ -\/=\ nb\ *\ d;\ \ err\ =\ std::max(err,\ d);}
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ nc.dot(dv);\ dv\ -\/=\ nc\ *\ d;\ \ err\ =\ std::max(err,\ d);}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dv\ /=\ dv(3);}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00939\ }
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ replace\ dual\ start\ of\ crossing\ edge\ with\ new\ vertex}}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ \ \ e.di\ =\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_ae87ebcc57e4633f622dfd43a52a1637a}{add\_dual}}(dv);}
\DoxyCodeLine{00942\ }
\DoxyCodeLine{00943\ }
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ add\ edge\ from\ new\ vertex\ to\ remaining\ old\ part}}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::cout\ <<\ "{}add\ edge\ "{}\ <<\ e.repr()\ <<\ "{}\ between\ new\ and\ old"{}\ <<\ std::endl;}}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(e);}
\DoxyCodeLine{00947\ }
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (first)\ \{}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ remember\ first\ edge\ to\ close\ the\ cycle\ later}}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \ \ \ \ first\_e\ =\ e;}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ \ \ first\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ not\ first\ edge,\ connect\ to\ previous}}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::cout\ <<\ "{}add\ edge\ between\ new\ and\ new"{}\ <<\ std::endl;}}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{e.pi,\ pi,\ prev\_e.\mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}},\ e.di\});}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00957\ }
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ remember\ last\ edge}}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ prev\_e\ =\ e;}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00961\ }
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ close\ cycle}}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!first)\ \{}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::cout\ <<\ "{}add\ closing\ edge"{}\ <<\ std::endl;}}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_acad279b95d009c4db4bbe61d6091c5e6}{add\_edge}}(\{first\_e.\mbox{\hyperlink{structpdedge_a13dbb678e2808fb85fa46af223b9babd}{pi}},\ pi,\ prev\_e.\mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}},\ first\_e.\mbox{\hyperlink{structpdedge_afb6f9263b5218b817b7a5254caecd627}{di}}\});}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00968\ }
\DoxyCodeLine{00969\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00970\ \ \ \ \ \ \ time-\/>start\_section(idx\_time\_remove);}
\DoxyCodeLine{00971\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00972\ }
\DoxyCodeLine{00973\ \ \ \ \ \ \ \textcolor{comment}{//\ remove\ old\ cut\ off\ dual\ vertices\ (including\ all\ connecting\ edges)}}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&di\ :\ remove\_di)}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_a710421718ab1e0d8edf3b3968d1e02a1}{remove\_dual}}(di);}
\DoxyCodeLine{00976\ }
\DoxyCodeLine{00977\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00978\ \ \ \ \ \ \ time-\/>end\_section();}
\DoxyCodeLine{00979\ \ \ \ \ \ \ remove\_count\ +=\ remove\_di.size();}
\DoxyCodeLine{00980\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00981\ }
\DoxyCodeLine{00982\ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (std::runtime\_error\ \&ex)\ \{}
\DoxyCodeLine{00983\ }
\DoxyCodeLine{00984\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00985\ \ \ \ \ \ \ time-\/>end\_section();}
\DoxyCodeLine{00986\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00987\ }
\DoxyCodeLine{00988\ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}in\ trying\ to\ add\ pi:"{}},\ pi);}
\DoxyCodeLine{00989\ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}integrity:"{}},\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_abb3e165068d82f1d4ef970099c95da87}{check\_integrity}}());}
\DoxyCodeLine{00990\ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}cut\_verts:"{}},\ remove\_di);}
\DoxyCodeLine{00991\ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}cycles:"{}},\ cycles);}
\DoxyCodeLine{00992\ \ \ \ \ \ \ py::print(\textcolor{stringliteral}{"{}added\ edges:"{}},\ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_ab1e6949bebcf78a1b22ddf9aee44da0e}{padj}}[pi]);}
\DoxyCodeLine{00993\ }
\DoxyCodeLine{00994\ \ \ \ \ \ \ \mbox{\hyperlink{classhalfspace__intersection_a8bb4f7925926d712ff86e0e9f668ef3f}{mesh}}.\mbox{\hyperlink{structpdmesh_ad0260a8d385485a8f25c05ffeb177610}{write\_ply}}(\textcolor{stringliteral}{"{}meshdump.ply"{}});}
\DoxyCodeLine{00995\ }
\DoxyCodeLine{00996\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00997\ \ \ \ \ \ \ time-\/>end\_section();}
\DoxyCodeLine{00998\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ ex;}
\DoxyCodeLine{01000\ \ \ \ \ \}}
\DoxyCodeLine{01001\ }
\DoxyCodeLine{01002\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{01003\ \ \ \ \ time-\/>end\_section();}
\DoxyCodeLine{01004\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01005\ }
\DoxyCodeLine{01006\ \ \ \ \ \textcolor{keywordflow}{return}\ phint;}
\DoxyCodeLine{01007\ \ \ \}}
\DoxyCodeLine{01008\ }
\DoxyCodeLine{01009\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classhalfspace__intersection_ac1525e9a9d66d359556e2630c5984e63}{bind}}(py::module\_\ \&m)\ \{}
\DoxyCodeLine{01010\ \ \ \ \ py::class\_<halfspace\_intersection<T>>(m,\ (\textcolor{stringliteral}{"{}HalfspaceIntersection\_"{}}\ +\ \mbox{\hyperlink{structtype__name_ad7cf8dab8ba9a198318e79bbf1747844}{type\_name<T>::value}}()).c\_str())}
\DoxyCodeLine{01011\ \ \ \ \ \ \ .def(py::init<\textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ \mbox{\hyperlink{classhalfspace__intersection_a1f42560747048ee440fd8fd6ec63d747}{halfspace\_intersection<T>::Vec3}}>\&,}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ \mbox{\hyperlink{classhalfspace__intersection_a1f42560747048ee440fd8fd6ec63d747}{halfspace\_intersection<T>::Vec3}}>\&>(),}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \ \ py::arg(\textcolor{stringliteral}{"{}lb"{}}),\ py::arg(\textcolor{stringliteral}{"{}ub"{}}))}
\DoxyCodeLine{01014\ \ \ \ \ \ \ .def(py::init<\textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ \mbox{\hyperlink{classhalfspace__intersection_a1f42560747048ee440fd8fd6ec63d747}{halfspace\_intersection<T>::Vec3}}>\&,}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ \mbox{\hyperlink{classhalfspace__intersection_a1f42560747048ee440fd8fd6ec63d747}{halfspace\_intersection<T>::Vec3}}>\&,}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<T,\ Eigen::Dynamic,\ 4,\ Eigen::RowMajor>>>(),}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ py::arg(\textcolor{stringliteral}{"{}lb"{}}),\ py::arg(\textcolor{stringliteral}{"{}ub"{}}),\ py::arg(\textcolor{stringliteral}{"{}hss"{}}))}
\DoxyCodeLine{01018\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}add\_halfspace"{}},\ \&\mbox{\hyperlink{classhalfspace__intersection}{halfspace\_intersection<T>::add\_halfspace}},}
\DoxyCodeLine{01019\ \ \ \ \ \ \ \ \ \ \ \ py::arg(\textcolor{stringliteral}{"{}hs"{}}),\ py::arg(\textcolor{stringliteral}{"{}hint"{}})=-\/1)}
\DoxyCodeLine{01020\ \ \ \ \ \ \ .def(\textcolor{stringliteral}{"{}add\_halfspaces"{}},\ \&\mbox{\hyperlink{classhalfspace__intersection}{halfspace\_intersection<T>::add\_halfspaces}},}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \ \ \ py::arg(\textcolor{stringliteral}{"{}hss"{}}))}
\DoxyCodeLine{01022\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{01023\ \ \ \ \ \ \ .def\_readonly(\textcolor{stringliteral}{"{}time"{}},\ \&\mbox{\hyperlink{classhalfspace__intersection}{halfspace\_intersection<T>::time}})}
\DoxyCodeLine{01024\ \ \ \ \ \ \ .def\_readonly(\textcolor{stringliteral}{"{}remove\_count"{}},\ \&\mbox{\hyperlink{classhalfspace__intersection}{halfspace\_intersection<T>::remove\_count}})}
\DoxyCodeLine{01025\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01026\ \ \ \ \ \ \ .def\_readonly(\textcolor{stringliteral}{"{}mesh"{}},\ \&\mbox{\hyperlink{classhalfspace__intersection}{halfspace\_intersection<T>::mesh}});}
\DoxyCodeLine{01027\ \ \ \}}
\DoxyCodeLine{01028\ \};}
\DoxyCodeLine{01029\ }
\DoxyCodeLine{01030\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01031\ }

\end{DoxyCode}
