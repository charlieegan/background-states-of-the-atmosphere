\doxysection{rasterizer.\+hpp}
\hypertarget{rasterizer_8hpp_source}{}\label{rasterizer_8hpp_source}\index{src/rasterizer.hpp@{src/rasterizer.hpp}}
\mbox{\hyperlink{rasterizer_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ RASTERIZER\_HPP}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ RASTERIZER\_HPP}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{common_8hpp}{common.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pool_8hpp}{pool.hpp}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}gfx/timsort.hpp"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrasterizer}{rasterizer}}}
\DoxyCodeLine{00009\ \{}
\DoxyCodeLine{00010\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00011\ \ \ \textcolor{comment}{//\ calculate\ y-\/coordinate\ of\ segment\ (extended\ to\ line)\ (x0,\ y0)\ -\/-\/\ (x1,\ y1)\ at\ x-\/coord\ x}}
\DoxyCodeLine{00012\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classrasterizer_a96fa1a32f79cd714b82dfb237435f0a2}{y\_at}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&x0,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&y0,}
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&x1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&y1,}
\DoxyCodeLine{00014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&x);}
\DoxyCodeLine{00015\ \ \ \textcolor{comment}{//\ calculate\ x-\/coordinate\ of\ segment\ (extended\ to\ line)\ (x0,\ y0)\ -\/-\/\ (x1,\ y1)\ at\ y-\/coord\ y}}
\DoxyCodeLine{00016\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classrasterizer_a9e457e18075097822219659516eb2146}{x\_at}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&x0,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&y0,}
\DoxyCodeLine{00017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&x1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&y1,}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&y);}
\DoxyCodeLine{00019\ \ \ \textcolor{comment}{//\ calculate\ the\ area\ of\ the\ intersection\ of\ the\ rectangle\ [xlo,\ xhi]\ x\ [ylo,\ yhi]\ with\ the}}
\DoxyCodeLine{00020\ \ \ \textcolor{comment}{//\ halfspace\ below\ the\ line\ connecting\ (xlo,\ syl)\ and\ (xhi,\ syr)}}
\DoxyCodeLine{00021\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classrasterizer_a5c4c7bfbc192ed3558e099ca226dc152}{rect\_intersect\_area}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&xlo,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&xhi,}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&ylo,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&yhi,}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&syl,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&syr);}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structrasterizer_1_1segment__cmp}{segment\_cmp}};}
\DoxyCodeLine{00026\ \ \ }
\DoxyCodeLine{00027\ \ \ \textcolor{comment}{//\ alignment\ is\ needed\ for\ events}}
\DoxyCodeLine{00028\ \ \ \textcolor{keyword}{struct\ }\textcolor{keyword}{alignas}(64)\ \mbox{\hyperlink{structrasterizer_1_1segment}{segment}}\ \{}
\DoxyCodeLine{00029\ \ \ \ \ Eigen::Vector2d\ \mbox{\hyperlink{structrasterizer_1_1segment_acf109bcc341b697ab41032a394650014}{s}},\ \mbox{\hyperlink{structrasterizer_1_1segment_aa418d0812376d95733a9ee785e84276a}{e}};\ \ \textcolor{comment}{//\ start\ and\ end\ point}}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structrasterizer_1_1segment_af3953e17bf0135bc5135ca52e607aba3}{idx}},\ \mbox{\hyperlink{structrasterizer_1_1segment_aa2069628b306ad39a398bfd5045ca8dc}{sidx}};\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ index\ of\ cell\ below\ (if\ it\ exists),\ index\ of\ segment}}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structrasterizer_1_1segment_a5cfdf490f52e67c5822409c3cd651415}{x0}};\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (current)\ start\ of\ trapezoid\ below\ segment}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ std::set<segment*>::iterator\ \mbox{\hyperlink{structrasterizer_1_1segment_a5f5efd6cd4d6e258f45681b097c4ced0}{self}};\ \textcolor{comment}{//\ set\ iterator\ (for\ line)\ of\ self\ (if\ it\ is\ in\ the\ line)}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{structrasterizer_1_1segment_a77d0443c454d691d1299c29061f12951}{segment}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00036\ \ \ \ \ }
\DoxyCodeLine{00037\ \ \ \ \ \mbox{\hyperlink{structrasterizer_1_1segment_a77d0443c454d691d1299c29061f12951}{segment}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Eigen::Vector2d>\ \&\mbox{\hyperlink{structrasterizer_1_1segment_acf109bcc341b697ab41032a394650014}{s}},}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<const\ Eigen::Vector2d>\ \&\mbox{\hyperlink{structrasterizer_1_1segment_aa418d0812376d95733a9ee785e84276a}{e}},}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&\mbox{\hyperlink{structrasterizer_1_1segment_af3953e17bf0135bc5135ca52e607aba3}{idx}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&\mbox{\hyperlink{structrasterizer_1_1segment_aa2069628b306ad39a398bfd5045ca8dc}{sidx}});\ \ \ \ }
\DoxyCodeLine{00040\ \ \ \ \ std::string\ \mbox{\hyperlink{structrasterizer_1_1segment_a95ad1ab28765684cf5fa55156300ac1f}{repr}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ precision\ =\ -\/1)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structrasterizer_1_1segment_aef9648fa1a669c6e7aae4b8d283e4204}{slope}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00043\ \ \ \ \ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structrasterizer_1_1segment_a044b3c44bcaf41086460416cc256c00c}{y\_at}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&x)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structrasterizer_1_1segment_aba06437450ed616cbb3228bd49d70d79}{x\_at}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&y)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00046\ \ \ \ \ }
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{//\ check\ if\ there\ is\ a\ unique\ (non-\/endpoint-\/)\ intersect\ with\ o,\ if\ intersecting\ set\ p\ to\ intersection\ point\ and\ return\ true}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ p(0)\ =:\ x\ will\ be\ the\ largest\ value\ such\ that\ y\_at(x)\ <=>\ o.y\_at(x)\ is\ the\ same\ as\ at\ small\ x}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ p(1)\ =:\ y\ will\ be\ the\ average\ of\ y\_at\ of\ the\ two\ segments}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrasterizer_1_1segment_ac50d255f16f81b40526d63e7da91c881}{intersect}}(\mbox{\hyperlink{structrasterizer_1_1segment}{segment}}\ \&o,\ Eigen::Vector2d\ \&p);}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structrasterizer_1_1segment_ad5f8440f89952869beaed074892f29a7}{bind}}(py::module\_\ \&m);}
\DoxyCodeLine{00053\ \ \ \};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structrasterizer_1_1segment__cmp}{segment\_cmp}}\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{structrasterizer_1_1segment__cmp_a6e4cd7e36709e3c0107f311ca92585c2}{cur\_x}};\ \textcolor{comment}{//\ x-\/coordinate\ to\ use\ for\ comparison}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \ \mbox{\hyperlink{structrasterizer_1_1segment__cmp_ad8fa1ea4ede937cf7d64b72f42a2e2cb}{segment\_cmp}}()\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{structrasterizer_1_1segment__cmp_ad8fa1ea4ede937cf7d64b72f42a2e2cb}{segment\_cmp}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structrasterizer_1_1segment__cmp}{segment\_cmp}}\ \&c);}
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{structrasterizer_1_1segment__cmp_ad8fa1ea4ede937cf7d64b72f42a2e2cb}{segment\_cmp}}(\textcolor{keywordtype}{double}\ *\mbox{\hyperlink{structrasterizer_1_1segment__cmp_a6e4cd7e36709e3c0107f311ca92585c2}{cur\_x}});}
\DoxyCodeLine{00061\ \ \ \ \ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrasterizer_1_1segment__cmp_a61f65ed8cce151e6f34ad1071e59c8b7}{operator()}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structrasterizer_1_1segment}{segment}}\ \&a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrasterizer_1_1segment}{segment}}\ \&b)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrasterizer_1_1segment__cmp_a61f65ed8cce151e6f34ad1071e59c8b7}{operator()}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structrasterizer_1_1segment}{segment}}\ *a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrasterizer_1_1segment}{segment}}\ *b)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00064\ \ \ \};}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structrasterizer_1_1event}{event}}\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structrasterizer_1_1event_a5dc077e2bbc76120bfff642eacb98372}{p}};}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \ \ \mbox{\hyperlink{structrasterizer_1_1event_a229d8586af5b0d881a257a5e1e2bbab3}{event}}();}
\DoxyCodeLine{00070\ \ \ \ \ \mbox{\hyperlink{structrasterizer_1_1event_a229d8586af5b0d881a257a5e1e2bbab3}{event}}(\mbox{\hyperlink{structrasterizer_1_1segment}{segment}}\ \&s,\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrasterizer_1_1event_a3153777fbba25cac186ad2f3d044f5d3}{start}});}
\DoxyCodeLine{00071\ \ \ \ \ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{comment}{//\ get\ the\ position\ of\ the\ event}}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Vector2d\&\ \mbox{\hyperlink{structrasterizer_1_1event_ae8e876c7edab3315ae75fbb9ea6ab5d9}{pos}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{comment}{//\ get\ whether\ the\ event\ represents\ a\ segment\ start}}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrasterizer_1_1event_a3153777fbba25cac186ad2f3d044f5d3}{start}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{//\ get\ the\ segment}}
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{structrasterizer_1_1segment}{segment}}*\ \mbox{\hyperlink{structrasterizer_1_1event_a6f4641fa9d44359768549b49f91f27e7}{seg}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structrasterizer_1_1event_a7c39b71433bb7db9e028b1a34d894262}{operator<}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structrasterizer_1_1event}{event}}\ \&lhs,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrasterizer_1_1event}{event}}\ \&rhs);}
\DoxyCodeLine{00080\ \ \ \ \ std::string\ \mbox{\hyperlink{structrasterizer_1_1event_aa5ba6c489d8954ca0fd7d4c9555afa45}{repr}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&precision\ =\ -\/1)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structrasterizer_1_1event_a8cd75ba9fa325a0f1c3e8367df76648d}{bind}}(py::module\_\ \&m);}
\DoxyCodeLine{00083\ \ \ \};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \textcolor{comment}{//std::list<segment>\ segs;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ all\ segments\ (with\ begin\ left\ of\ end;\ vertical\ segments\ are\ left\ out)}}
\DoxyCodeLine{00086\ \ \ \mbox{\hyperlink{classpool}{pool<segment,\ 1024>}}\ \mbox{\hyperlink{classrasterizer_a8f53cd5067ae73ef1b7b8db3142e0e66}{segs}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ all\ segments\ (with\ begin\ left\ of\ end;\ vertical\ segments\ are\ left\ out)}}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordtype}{double}\ *\mbox{\hyperlink{classrasterizer_aa33781f2081447def4b0bd20abe792f8}{cur\_x}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ x-\/coord\ of\ sweep\ line}}
\DoxyCodeLine{00088\ \ \ \mbox{\hyperlink{structrasterizer_1_1segment__cmp}{segment\_cmp}}\ \mbox{\hyperlink{classrasterizer_ad0663f760239fc246be57434c36a4622}{cmp}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ segment\ comparator}}
\DoxyCodeLine{00089\ \ \ std::set<segment*,\ segment\_cmp>\ \mbox{\hyperlink{classrasterizer_a92f8fc1ea4f30bf18b85ea986a75f269}{line}};\ \ \ \ \ \textcolor{comment}{//\ current\ sweep\ line}}
\DoxyCodeLine{00090\ \ \ std::vector<event>\ \mbox{\hyperlink{classrasterizer_a81aadc5c347158334c38d1f9916aab3d}{events}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ segment\ start\ /\ end\ events}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ Eigen::VectorXd\ \mbox{\hyperlink{classrasterizer_ab4efa643fd40ef5e0dc62f08c8d7500d}{val}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ value\ of\ function\ on\ cells}}
\DoxyCodeLine{00093\ \ \ }
\DoxyCodeLine{00094\ \ \ Eigen::Matrix<double,\ Eigen::Dynamic,\ Eigen::Dynamic,\ Eigen::RowMajor>\ \mbox{\hyperlink{classrasterizer_aaab7780b554dc64d72da10b810eded71}{out}},\ \mbox{\hyperlink{classrasterizer_a731d0fe1fc2cd3c771a254e67b08a176}{fill}};}
\DoxyCodeLine{00095\ \ \ Eigen::Array4d\ \mbox{\hyperlink{classrasterizer_a1eb5da1ae1a128c30c24dbb22eee268c}{bounds}};}
\DoxyCodeLine{00096\ \ \ Eigen::Array2d\ \mbox{\hyperlink{classrasterizer_a4f33964bbc35054aa678919f73c3518d}{lb}},\ \mbox{\hyperlink{classrasterizer_a02fc7ce0239ce4ac2e73d9ddc9fe1234}{step}};}
\DoxyCodeLine{00097\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classrasterizer_ab657ada7becc1d81811c25d4a39ed729}{pixA}};}
\DoxyCodeLine{00098\ \ \ \textcolor{comment}{//\ pixel\ (i,\ j)\ represents\ area\ lb\ +\ (i,\ j)\string^T\ *\ step\ (pointwise\ multiplication)}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#ifdef\ PROFILING}}
\DoxyCodeLine{00101\ \ \ std::shared\_ptr<timer>\ time\ =\ NULL;}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_prepare\ =\ -\/1;}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_sort\_events\ =\ -\/1;}
\DoxyCodeLine{00104\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_prepare\ =\ -\/1;}
\DoxyCodeLine{00105\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_neighbors\ =\ -\/1;}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_intersect\ =\ -\/1;}
\DoxyCodeLine{00107\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_noint\ =\ -\/1;}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_select\ =\ -\/1;}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_erase\_line\ =\ -\/1;}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_erase\_events\ =\ -\/1;}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_make\_segments\ =\ -\/1;}
\DoxyCodeLine{00112\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_upper\_bound\_iterate\ =\ -\/1;}
\DoxyCodeLine{00113\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersects\_end\_erase\ =\ -\/1;}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_intersect\_post\ =\ -\/1;}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_rasterize\_prepare\ =\ -\/1;}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_rasterize\_upper\_bound\ =\ -\/1;}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_rasterize\_add\_start\ =\ -\/1;}
\DoxyCodeLine{00118\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_rasterize\_add\_end\ =\ -\/1;}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_rasterize\_line\_insert\ =\ -\/1;}
\DoxyCodeLine{00120\ \ \ \textcolor{keywordtype}{int}\ idx\_time\_rasterize\_line\_erase\ =\ -\/1;}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \textcolor{keywordtype}{void}\ setup\_timer();}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00124\ \ \ }
\DoxyCodeLine{00125\ \ \ \mbox{\hyperlink{classrasterizer_a22170481005ed75c444ecb380e23d516}{rasterizer}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \mbox{\hyperlink{classrasterizer_a638a2e8f143a6fa653183a985e9fa082}{rasterizer}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classrasterizer}{rasterizer}}\ \&o)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00128\ \ \ }
\DoxyCodeLine{00129\ \ \ \mbox{\hyperlink{classrasterizer_a22170481005ed75c444ecb380e23d516}{rasterizer}}(\mbox{\hyperlink{classrasterizer}{rasterizer}}\ \&\&o);}
\DoxyCodeLine{00130\ \ \ }
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//\ seg\ =\ (geometric)\ segments;\ seg[i]\ =\ \{start\ point,\ end\ point,\ index\ of\ cell\ below\ segment\};\ segments\ should\ include\ top\ and\ bottom\ but\ not\ left\ and\ right\ border\ (direction\ does\ not\ matter)}}
\DoxyCodeLine{00132\ \ \ \textcolor{comment}{//\ bounds\ =\ (left,\ right,\ bottom,\ top)\ boundaries\ left\ <\ right\ bounds\ coordinate\ 0;\ bottom\ <\ top\ bounds\ coordinate\ 1}}
\DoxyCodeLine{00133\ \ \ \mbox{\hyperlink{classrasterizer_a22170481005ed75c444ecb380e23d516}{rasterizer}}(\textcolor{keyword}{const}\ std::vector<std::tuple<Eigen::Vector2d,\ Eigen::Vector2d,\ int>>\ \&seg,}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<const\ Eigen::Array4d>\ \&\mbox{\hyperlink{classrasterizer_a1eb5da1ae1a128c30c24dbb22eee268c}{bounds}});}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \mbox{\hyperlink{classrasterizer_a480f140d2227982bf6040ae434d720ff}{\string~rasterizer}}();}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \textcolor{comment}{//\ val\ =\ values\ of\ cells}}
\DoxyCodeLine{00139\ \ \ \textcolor{comment}{//\ res\ =\ resolution\ the\ result\ shall\ have}}
\DoxyCodeLine{00140\ \ \ Eigen::Ref<const\ Eigen::Matrix<double,\ Eigen::Dynamic,\ Eigen::Dynamic,\ Eigen::RowMajor>>}
\DoxyCodeLine{00141\ \ \ \mbox{\hyperlink{classrasterizer_a44372b47724338f399d78e3489c70be7}{rasterize}}(\textcolor{keyword}{const}\ Eigen::Ref<const\ Eigen::VectorXd>\ \&\mbox{\hyperlink{classrasterizer_ab4efa643fd40ef5e0dc62f08c8d7500d}{val}},}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Ref<const\ Eigen::Array2i>\ \&res);}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrasterizer_ab0dd78b8b43c0f17d3684ee8366f6c64}{bind}}(py::module\_\ \&m);}
\DoxyCodeLine{00145\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \textcolor{comment}{//\ find\ all\ intersects,\ split\ segments\ to\ remove\ intersects,\ update\ events\ accordingly}}
\DoxyCodeLine{00148\ \ \ \textcolor{comment}{//\ currently\ assumes\ there\ are\ no\ 3\ segments\ intersecting\ in\ 1\ point\ TODO:\ handle\ that\ case\ too}}
\DoxyCodeLine{00149\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classrasterizer_ac6114e658bb27e124bd276a07418ecba}{fix\_intersects}}();}
\DoxyCodeLine{00150\ \ \ }
\DoxyCodeLine{00151\ \ \ \textcolor{comment}{//\ for\ given\ x,\ find\ pixel\ column\ containing\ it}}
\DoxyCodeLine{00152\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classrasterizer_a0b65e61f61ae9d9b38b51f6f53a931c2}{x\_to\_pixel}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&x)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00153\ \ \ \textcolor{comment}{//\ for\ given\ y,\ gind\ pixel\ row\ containing\ it}}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classrasterizer_a66921354af957cfd857d1c2a1c935054}{y\_to\_pixel}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&y)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00155\ \ \ \textcolor{comment}{//\ for\ given\ i,\ give\ start\ of\ pixel\ column\ i}}
\DoxyCodeLine{00156\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classrasterizer_a6fc1c6fc77e20146f864df8b35402e2e}{pixel\_to\_x}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&i)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00157\ \ \ \textcolor{comment}{//\ for\ given\ j,\ give\ start\ of\ pixel\ row\ j}}
\DoxyCodeLine{00158\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classrasterizer_a704a90b9118e355f72ce2d6d5458972c}{pixel\_to\_y}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \&j)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrasterizer_a764956c24f744ccb8d795002fff3d1d6}{add\_area\_between}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structrasterizer_1_1segment}{segment}}\ *s0,\ \mbox{\hyperlink{structrasterizer_1_1segment}{segment}}\ *s1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \&x1);}
\DoxyCodeLine{00161\ \};}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
